<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Force favicon load (GitHub Pages safe) -->
    <link rel="icon" href="/trust-supply-dashboard/favicon.ico?v=2" type="image/x-icon">
    <link rel="shortcut icon" href="/trust-supply-dashboard/favicon.ico?v=2" type="image/x-icon">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unofficial Trust.Supply Economic Dashboard v1.0.1</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.26.0/plotly.min.js"></script>
    <style>
        /* ==================== DESIGN SYSTEM ==================== */
        :root {
            --primary: #667eea;
            --primary-dark: #764ba2;
            --success: #28a745;
            --success-light: #d4edda;
            --warning: #ffc107;
            --warning-light: #fff3cd;
            --danger: #dc3545;
            --danger-light: #f8d7da;
            --info: #17a2b8;
            --info-light: #d1ecf1;
            --gray-100: #f8f9fa;
            --gray-200: #e9ecef;
            --gray-500: #6c757d;
            --gray-700: #495057;
            --shadow-sm: 0 2px 6px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.12);
            --shadow-glow: 0 4px 16px rgba(102, 126, 234, 0.3);
            --radius: 10px;
            --transition: all 0.3s ease;
        }
        
        /* BASE */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif; 
               background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); 
               padding: 20px; color: #333; }
        .container { max-width: 1600px; margin: 0 auto; background: white; border-radius: 20px; 
                    box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
        
        /* HEADER */
        header { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); 
                color: white; padding: 30px; text-align: center; }
        header h1 { font-size: 2.5em; margin-bottom: 10px; font-weight: 700; }
        header p { opacity: 0.9; font-size: 1.1em; }
        
        /* CONTROLS */
        .controls { background: var(--gray-100); padding: 30px; border-bottom: 2px solid var(--gray-200); }
        .control-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); 
                       gap: 15px; margin-bottom: 15px; }
        .control-group { background: white; padding: 12px; border-radius: var(--radius); 
                        box-shadow: var(--shadow-sm); transition: var(--transition); }
        .control-group:hover { box-shadow: var(--shadow-md); }
        .control-group.highlight { background: linear-gradient(135deg, var(--warning-light) 0%, #ffe8a1 100%); 
                                  border: 2px solid var(--warning); box-shadow: 0 4px 12px rgba(255,193,7,0.3); }
        .control-group label { display: block; font-weight: 600; margin-bottom: 6px; 
                              color: var(--gray-700); font-size: 0.85em; text-transform: uppercase; 
                              letter-spacing: 0.5px; }
        .control-group input { width: 100%; padding: 8px; border: 2px solid var(--gray-200); 
                              border-radius: 6px; font-size: 0.95em; transition: var(--transition); }
        .control-group input:focus { outline: none; border-color: var(--primary); 
                                     box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); }
        .control-group input[readonly] { background: var(--gray-100); color: var(--gray-500); }
        
        /* SLIDER */
        .slider-container { grid-column: 1 / -1; background: linear-gradient(135deg, var(--info-light) 0%, white 100%); 
                           padding: 20px; border-radius: var(--radius); border: 2px solid var(--info); }
        .slider-value { display: inline-block; background: var(--primary); color: white; 
                       padding: 5px 15px; border-radius: 20px; font-weight: 600; margin-left: 10px; }
        .slider-container input[type="range"] { width: 100%; height: 8px; border-radius: 5px; 
                                                background: linear-gradient(to right, var(--success) 0%, var(--warning) 50%, var(--danger) 100%); 
                                                outline: none; -webkit-appearance: none; margin: 15px 0; }
        .slider-container input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; 
                                                                      width: 24px; height: 24px; border-radius: 50%; 
                                                                      background: var(--primary); cursor: pointer; 
                                                                      box-shadow: var(--shadow-md); transition: var(--transition); }
        .slider-container input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.2); 
                                                                             box-shadow: var(--shadow-glow); }
        .velocity-explanation { background: rgba(255,255,255,0.7); padding: 12px; border-radius: 6px; 
                               margin-top: 8px; font-size: 0.85em; line-height: 1.5; 
                               border-left: 4px solid var(--info); }
        
        /* METRICS */
        .metrics { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); 
                  gap: 20px; padding: 30px; background: white; }
        .metric-card { color: white; padding: 20px; border-radius: var(--radius); text-align: center; 
                      transition: var(--transition); box-shadow: var(--shadow-md); }
        .metric-card:hover { transform: translateY(-4px); box-shadow: var(--shadow-lg); }
        .metric-card h3 { font-size: 0.9em; opacity: 0.9; margin-bottom: 10px; font-weight: 600; 
                         text-transform: uppercase; letter-spacing: 1px; }
        .metric-card .value { font-size: clamp(1.4em, 3vw, 2em); font-weight: 700; word-wrap: break-word; }
        .metric-card small { font-size: 0.8em; opacity: 0.9; display: block; margin-top: 5px; }
        
        /* CONTENT & TABS */
        .content { padding: 30px; }
        .tabs { display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; 
               background: linear-gradient(135deg, #00b4d8 0%, #0096c7 100%); 
               padding: 12px; border-radius: 12px; box-shadow: var(--shadow-lg); }
        .tab { padding: 14px 28px; cursor: pointer; border: none; 
              background: rgba(255, 255, 255, 0.95); 
              font-size: 1em; color: #023e8a; border-radius: 8px; 
              transition: var(--transition); font-weight: 500; 
              box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); 
              position: relative; overflow: hidden; 
              border: 2px solid transparent; }
        .tab:hover { color: #03045e; 
                    background: linear-gradient(135deg, #ffffff 0%, #caf0f8 100%); 
                    transform: translateY(-2px); 
                    box-shadow: 0 4px 12px rgba(0, 180, 216, 0.4);
                    border-color: #48cae4; }
        .tab.active { color: white; 
                     background: linear-gradient(135deg, #03045e 0%, #023e8a 100%); 
                     font-weight: 600; transform: translateY(-2px); 
                     box-shadow: 0 4px 16px rgba(3, 4, 94, 0.5);
                     border-color: #0077b6; }
        .tab.active::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
                             background: linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0) 100%); }
        .tab-content { display: none; animation: fadeIn 0.3s; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* CARDS */
        .card { background: white; border: 1px solid var(--gray-200); border-radius: var(--radius); 
               padding: 25px; margin-bottom: 25px; box-shadow: var(--shadow-md); 
               transition: var(--transition); }
        .card:hover { box-shadow: var(--shadow-lg); }
        .card h3 { color: var(--primary); margin-bottom: 20px; font-size: 1.4em; font-weight: 600; }
        
        /* INFO ITEMS */
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; }
        .info-item { text-align: center; padding: 20px; 
                    background: linear-gradient(135deg, var(--gray-100) 0%, white 100%); 
                    border-radius: var(--radius); border: 2px solid var(--gray-200); 
                    transition: var(--transition); }
        .info-item:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); 
                          border-color: var(--primary); }
        .info-item strong { display: block; font-size: 1.6em; color: var(--primary); 
                           margin-bottom: 8px; font-weight: 700; }
        .info-item span { color: var(--gray-500); font-size: 0.9em; font-weight: 500; }
        
        /* TABLES */
        table { width: 100%; border-collapse: collapse; background: white; border-radius: var(--radius); 
               overflow: hidden; box-shadow: var(--shadow-md); }
        thead { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); color: white; }
        th { padding: 14px 12px; text-align: left; font-size: 0.85em; font-weight: 600; 
            text-transform: uppercase; letter-spacing: 0.5px; }
        td { padding: 12px; font-size: 0.9em; }
        td:not(:first-child):not(:nth-child(2)) { text-align: right; }
        tbody tr { border-bottom: 1px solid var(--gray-200); transition: var(--transition); }
        tbody tr:hover { background: var(--gray-100); }
        tbody tr:last-child { border-bottom: none; }
        
        /* CHARTS */
        .chart-container { height: 600px; margin: 20px 0; padding: 20px; 
                          background: linear-gradient(135deg, var(--gray-100) 0%, white 100%); 
                          border-radius: var(--radius); border: 2px solid var(--gray-200); 
                          box-shadow: var(--shadow-sm); }
        
        /* ALERTS */
        .alert-box { padding: 18px; border-radius: var(--radius); margin: 15px 0; 
                    border-left: 4px solid; box-shadow: var(--shadow-sm); }
        .alert-info { background: var(--info-light); border-color: var(--info); color: #0c5460; }
        .alert-success { background: var(--success-light); border-color: var(--success); color: #155724; }
        .alert-warning { background: var(--warning-light); border-color: var(--warning); color: #856404; }
        .alert-danger { background: var(--danger-light); border-color: var(--danger); color: #721c24; }
        
        /* BUTTONS */
        button.calculate-btn { width: 100%; padding: 15px; 
                              background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); 
                              color: white; border: none; border-radius: var(--radius); font-size: 1.1em; 
                              font-weight: 600; cursor: pointer; transition: var(--transition); 
                              box-shadow: var(--shadow-md); }
        button.calculate-btn:hover { transform: translateY(-2px); box-shadow: var(--shadow-glow); }
        
        /* SPECIAL BOXES */
        .launch-impact-box { background: linear-gradient(135deg, var(--info) 0%, #138496 100%); 
                            color: white; padding: 25px; border-radius: var(--radius); margin: 25px 0; 
                            box-shadow: var(--shadow-lg); }
        .launch-impact-box h4 { margin-bottom: 15px; font-size: 1.3em; font-weight: 600; }
        .cliff-info-boxes { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
                           gap: 15px; margin-top: 20px; }
        .cliff-box { padding: 18px; border-radius: var(--radius); text-align: center; 
                    box-shadow: var(--shadow-sm); transition: var(--transition); }
        .cliff-box:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); }
        .cliff-box strong { display: block; font-size: 1.3em; margin-bottom: 8px; }
        .overhang-box { background: var(--warning-light); border-left: 4px solid var(--warning); 
                       padding: 20px; border-radius: var(--radius); margin: 20px 0; box-shadow: var(--shadow-sm); }
        .evls-warning { background: var(--warning-light); border-left: 4px solid #ff9800; 
                       padding: 15px; border-radius: var(--radius); margin-top: 15px; 
                       font-size: 0.9em; box-shadow: var(--shadow-sm); }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ Unofficial Trust.Supply Economic Dashboard v1.0.1</h1>
            <p>Advanced validator economics, treasury modeling & EVLS analysis</p>
            <p style="font-size: 0.9em; opacity: 0.8; margin-top: 10px;">üìÖ Last Update: 20 January 2026</p>
            <div style="background: rgba(255,255,255,0.15); padding: 15px; border-radius: 8px; margin-top: 15px; font-size: 0.85em; line-height: 1.6; text-align: left; max-width: 900px; margin-left: auto; margin-right: auto; backdrop-filter: blur(10px);">
                <strong>‚ö†Ô∏è Disclaimer:</strong> This is an unofficial, community-created analytical tool. All data is derived from publicly available on-chain sources. Economic models, formulas, and projections are provided by @trippledutch for informational and educational purposes only. <strong>This dashboard does not constitute financial, investment, or legal advice.</strong> Numbers presented may contain errors or inaccuracies. Morpheus.Network, Trust.Supply, and all associated parties bear no responsibility for the accuracy of information displayed herein. Users assume all risk and responsibility for any decisions made based on this dashboard. Always conduct your own research and consult qualified professionals before making investment decisions.
            </div>
        </header>

        <div class="controls">
            <!-- LINE 1: Core Network Metrics -->
            <div class="control-grid">
                <div class="control-group">
                    <label>Active Nodes</label>
                    <input type="text" id="totalNodes" value="4,339" oninput="updateCalculatedFields(); updateNetworkDisplays(); updateMyNodesActiveNodes(); calculate()">
                </div>
                <div class="control-group">
                    <label>Active Validators</label>
                    <input type="text" id="activeValidators" value="108" oninput="updateNetworkDisplays(); calculate()">
                </div>
                <div class="control-group">
                    <label>Stake Per Node</label>
                    <input type="text" id="stakePerNode" value="1,800" oninput="updateCalculatedFields(); calculate()">
                </div>
                <div class="control-group">
                    <label>Total Staked</label>
                    <input type="text" id="totalStaked" value="7,785,000" readonly>
                </div>
                <div class="control-group highlight">
                    <label>Daily Validations üî•</label>
                    <input type="text" id="dailyValidations" value="17,900" oninput="updateYearlyValidations(); updateActiveNodesFromValidations(); calculate(); calculateMyNodes()">
                    <small style="display: block; margin-top: 5px; font-size: 0.8em; color: #856404;">Drives network growth & price</small>
                </div>
                <div class="control-group highlight">
                    <label>Current Price ($) üí∞</label>
                    <input type="number" id="currentPrice" value="0.062" step="0.00001" oninput="calculate(); calculateMyNodes()">
                    <small style="display: block; margin-top: 5px; font-size: 0.8em; color: #856404;">Auto-scales with validation growth</small>
                </div>
                <div class="control-group">
                    <label>Yearly Validations</label>
                    <input type="text" id="yearlyValidations" value="5,491,790" readonly>
                </div>
            </div>
            
            <!-- NEW v5.5: SCENARIO MODELING SLIDERS -->
            <div class="control-grid" style="margin-top: 20px;">
                <!-- Transaction Growth Multiplier Slider -->
                <div class="control-group" style="grid-column: span 2; background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); padding: 15px; border-radius: 8px; border: 2px solid #2196f3;">
                    <label style="font-weight: bold; color: #1976d2;">üìà Transaction Growth Multiplier</label>
                    <div style="display: flex; align-items: center; gap: 15px; margin-top: 10px;">
                        <input type="range" id="transactionMultiplier" min="0.5" max="10" step="0.1" value="1" 
                               style="flex: 1;" oninput="updateTransactionMultiplier()">
                        <span id="transactionMultiplierValue" style="font-weight: bold; min-width: 60px; color: #1976d2;">1.0x</span>
                    </div>
                    <small style="display: block; margin-top: 8px; font-size: 0.85em; color: #1565c0;">
                        Scales daily validations AND price together (utility-driven model). Use Price Override slider to model independent price movements.
                    </small>
                </div>
                
                <!-- Price Override Slider -->
                <div class="control-group" style="grid-column: span 2; background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); padding: 15px; border-radius: 8px; border: 2px solid #ff9800;">
                    <label style="font-weight: bold; color: #e65100;">üí∞ Price Override Multiplier</label>
                    <div style="display: flex; align-items: center; gap: 15px; margin-top: 10px;">
                        <input type="range" id="priceMultiplier" min="0.5" max="10" step="0.1" value="1" 
                               style="flex: 1;" oninput="updatePriceMultiplier()">
                        <span id="priceMultiplierValue" style="font-weight: bold; min-width: 60px; color: #e65100;">1.0x</span>
                    </div>
                    <small style="display: block; margin-top: 8px; font-size: 0.85em; color: #ef6c00;">
                        Independent price adjustment (0.5x = $0.043 ‚Üí 10x = $0.856). Does NOT affect transaction volume.
                    </small>
                </div>
            </div>
            
            <!-- NEW: Load Latest Data Button -->
            <div style="text-align: center; margin-top: 15px;">
                <button onclick="loadLatestData(event)" style="
                    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
                    color: white;
                    border: none;
                    padding: 12px 30px;
                    border-radius: 8px;
                    font-size: 1em;
                    font-weight: bold;
                    cursor: pointer;
                    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                    transition: all 0.3s ease;
                " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 12px rgba(0,0,0,0.15)';" 
                   onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">
                    üì• Load Latest Data
                </button>
                <div id="updateStatus" style="margin-top: 10px; font-size: 0.9em; color: #666;"></div>
            </div>
            
            <!-- LINE 2: MNW Supply Distribution -->
            <div class="control-grid">
                <div class="control-group">
                    <label>Total Supply</label>
                    <input type="text" id="totalSupply" value="47,897,218" max="47897218" oninput="calculate()">
                </div>
                <div class="control-group">
                    <label>Current Team Wallet</label>
                    <input type="text" id="teamWallet" value="1,451,053" oninput="calculate()">
                </div>
                <div class="control-group">
                    <label>Current DEX Liquidity</label>
                    <input type="text" id="dexLiquidity" value="1,066,120" readonly>
                    <small style="display: block; margin-top: 5px; font-size: 0.75em; color: #6c757d;">Sushiswap, Uniswap</small>
                </div>
                <div class="control-group">
                    <label>CEX Locked</label>
                    <input type="text" id="cexLocked" value="3,381,385" oninput="calculate()">
                </div>
                <div class="control-group">
                    <label>Polygon MNW</label>
                    <input type="text" id="polygonMNW" value="5,476,086" oninput="calculate()">
                    <small style="display: block; margin-top: 5px; font-size: 0.75em; color: #6c757d;">Bridged, not staked</small>
                </div>
                <div class="control-group">
                    <label>Ethereum MNW</label>
                    <input type="text" id="ethereumMNW" value="28,690,921" oninput="calculate()">
                </div>
                <div class="control-group">
                    <label>Lost MNW</label>
                    <input type="text" id="lostTokens" value="500,000" oninput="calculate()">
                </div>
            </div>
            
            <!-- LINE 3: Node Stake Tiers -->
            <div class="control-grid">
                <div class="control-group">
                    <label>3m Nodes</label>
                    <input type="text" id="nodes3m" value="441" oninput="updateCalculatedFields(); calculate()">
                </div>
                <div class="control-group">
                    <label>3m Reward</label>
                    <input type="number" id="reward3m" value="0.06" step="0.01" oninput="calculate()">
                </div>
                <div class="control-group">
                    <label>6m Nodes</label>
                    <input type="text" id="nodes6m" value="357" oninput="updateCalculatedFields(); calculate()">
                </div>
                <div class="control-group">
                    <label>6m Reward</label>
                    <input type="number" id="reward6m" value="0.08" step="0.01" oninput="calculate()">
                </div>
                <div class="control-group">
                    <label>12m Nodes</label>
                    <input type="text" id="nodes12m" value="3,540" oninput="updateCalculatedFields(); calculate()">
                </div>
                <div class="control-group">
                    <label>12m Reward</label>
                    <input type="number" id="reward12m" value="0.10" step="0.01" oninput="calculate()">
                </div>
            </div>
            
            <div id="rewardCalcInfo" style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 12px; margin: 15px 0; border-radius: 4px;">
                <strong>‚ÑπÔ∏è About Reward Calculation:</strong> The weighted average (shown as "Avg Reward") represents MNW paid <strong>per validation</strong>, not per MNW staked. 
                Base network emissions = Daily Validations √ó Avg Reward √ó 365 = <span id="baseEmissions">--</span>M MNW/year (gross). 
                <strong>Yearly Rewards</strong> accounts for EVLS penalties (~3% reduction) giving actual network emissions of ~<span id="netEmissions">--</span>M MNW/year (net).
            </div>

            <!-- LINE 4: Velocity Slider -->
            <div class="control-grid">
                <div class="control-group slider-container">
                    <label>Velocity Factor <span class="slider-value" id="velocityDisplay">2.5x</span></label>
                    <input type="range" id="velocitySlider" min="0.5" max="10.0" step="0.1" value="2.5" oninput="updateVelocity(); calculate()">
                    <small id="velocityInterpretation">Moderate trading - Mix of holding and selling to cover costs</small>
                    <div class="velocity-explanation">
                        <strong>üí° What is Velocity?</strong> Velocity measures how many times a token changes hands in a period. Higher velocity = more selling pressure. MV=PQ formula: (Market Cap √ó Velocity) = (Price √ó Quantity of transactions). If validators immediately sell rewards, velocity increases, requiring more market cap to maintain price. If validators stake/hold, velocity decreases, making price more stable with less trading volume needed.
                    </div>
                </div>
            </div>
        </div>

        <!-- MNW Supply Distribution -->
        <div class="card" style="margin: 20px 30px;">
            <h3>üí∞ MNW Supply Distribution</h3>
        </div>
        <div class="metrics" id="metricsDisplay"></div>

        <!-- MNW Supply Verification Table -->
        <div class="card" style="margin: 20px 30px;">
            <h3>üìã MNW Supply Verification (47,897,218 Total)</h3>
            <table style="width: auto; margin: 0 auto;">
                <thead>
                    <tr>
                        <th style="text-align: left; padding: 12px 20px;">Category</th>
                        <th style="text-align: right; padding: 12px 20px; white-space: nowrap;">MNW Amount</th>
                        <th style="text-align: right; padding: 12px 15px; white-space: nowrap;">%</th>
                    </tr>
                </thead>
                <tbody id="verificationTableBody">
                </tbody>
            </table>
        </div>

        <div class="launch-impact-box">
            <h4>üöÄ Suite.Supply Launch Impact & Network Scaling Projections</h4>
            <p style="margin-bottom: 15px; font-weight: 600; color: rgba(255,255,255,0.9);">Current Network Status:</p>
            <div class="info-grid">
                <div class="info-item" style="background: white;">
                    <strong id="currentVals">18,500</strong>
                    <span>Current Validations/Day</span>
                </div>
                <div class="info-item" style="background: white;">
                    <strong>50K ‚Üí ‚àû/Day</strong>
                    <span>Post-Launch Potential</span>
                </div>
                <div class="info-item" style="background: white;">
                    <strong id="nodesDisplay">4,335</strong>
                    <span>Current Nodes</span>
                    <div style="margin-top: 5px; font-size: 0.85em; color: #6c757d;" id="currentValidatorsDisplay">108 validators globally</div>
                </div>
                <div class="info-item" style="background: white;">
                    <strong>150+</strong>
                    <span>Integrations Ready</span>
                </div>
            </div>
            
            <h4 style="margin-top: 20px; font-size: 1.1em;">Expected Growth Scenarios (Square Root Scaling Model)</h4>
            <div class="info-grid" style="margin-top: 10px;">
                <div class="info-item" style="background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); border: 3px solid #28a745; color: #155724;">
                    <strong id="expected3xVals" style="color: #155724;">45,000</strong>
                    <span style="color: #155724; font-weight: 600;">3x Validations/Day</span>
                    <div style="margin-top: 8px; font-size: 0.9em; color: #155724;">
                        <div id="expected3xNodes">~7,491 Nodes</div>
                        <div id="expected3xValidators">~187 Validators</div>
                        <div style="margin-top: 5px; color: #155724; font-weight: bold; font-size: 1.1em;" id="expected3xPrice">Price: $0.23</div>
                    </div>
                </div>
                <div class="info-item" style="background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%); border: 3px solid #ffc107; color: #856404;">
                    <strong id="expected10xVals" style="color: #856404;">150,000</strong>
                    <span style="color: #856404; font-weight: 600;">10x Validations/Day</span>
                    <div style="margin-top: 8px; font-size: 0.9em; color: #856404;">
                        <div id="expected10xNodes">~13,676 Nodes</div>
                        <div id="expected10xValidators">~341 Validators</div>
                        <div style="margin-top: 5px; color: #856404; font-weight: bold; font-size: 1.1em;" id="expected10xPrice">Price: $0.78</div>
                    </div>
                </div>
                <div class="info-item" style="background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%); border: 3px solid #dc3545; color: #721c24;">
                    <strong id="expected100xVals" style="color: #721c24;">1,500,000</strong>
                    <span style="color: #721c24; font-weight: 600;">100x Validations/Day</span>
                    <div style="margin-top: 8px; font-size: 0.9em; color: #721c24;">
                        <div id="expected100xNodes">20,000 Nodes (MAX)</div>
                        <div id="expected100xValidators">500 Validators</div>
                        <div style="margin-top: 5px; color: #721c24; font-weight: bold; font-size: 1.1em;" id="expected100xPrice">Price: $7.76</div>
                    </div>
                </div>
            </div>
            
            <div class="alert-box alert-warning" style="margin-top: 15px;" id="capacityModelBox">
                <strong>‚ö†Ô∏è Network Capacity Model:</strong> <span id="capacityModelText">Node growth follows square root of validation growth (diminishing returns). Maximum: 20,000 nodes (36M MNW staked = 75% of supply). Validators scale at 1:40 ratio.</span> <strong style="color: #28a745;">VITAL: Above 66,450 daily validations, team wallet depletes completely - buyback mechanism becomes mandatory!</strong> DEX liquidity is dynamically set to 15% of MNW in retail wallets (Small Wallets + Lost Tokens), reflecting natural trading activity.
            </div>
        </div>

        <div id="validationThresholdAlert" style="display: none; margin: 20px 30px; padding: 20px; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; border-radius: 10px; border: 3px solid #155724; box-shadow: 0 4px 12px rgba(40,167,69,0.4);">
            <h3 style="margin: 0 0 10px 0; font-size: 1.3em;">‚úÖ VALIDATION THRESHOLD EXCEEDED - BUYBACK MECHANISM ACTIVATED!</h3>
            <p style="margin: 0; font-size: 1.1em; line-height: 1.5;">
                Daily validations have exceeded <strong>66,450</strong>. The team wallet is now <strong>DEPLETED</strong>. 
                This is a <strong>VITAL MILESTONE</strong>! All validator rewards are now funded through <strong>market buybacks</strong>, creating constant buy pressure. 
                The network has successfully transitioned to a <strong>fully decentralized, deflationary reward mechanism</strong> - bullish for MNW price! üöÄ
            </p>
        </div>

        <div class="content">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('table')">üìä Economic Matrix</button>
                <button class="tab" onclick="switchTab('validations')">üìà Validation Requirements</button>
                <button class="tab" onclick="switchTab('runway')">üí∞ Treasury Runway</button>
                <button class="tab" onclick="switchTab('cliffEvents')">‚ö†Ô∏è 2026 Cliff Events</button>
                <button class="tab" onclick="switchTab('buyback')">üí∏ Buyback Pressure</button>
                <button class="tab" onclick="switchTab('velocityTab')">üîÑ Velocity Impact</button>
            </div>

            <div id="table" class="tab-content active">
                <div class="card">
                    <h3>üìà Complete Economic Projection Matrix</h3>
                    <div style="overflow-x: auto;">
                        <div id="tableContainer"></div>
                    </div>
                </div>
            </div>

            <div id="validations" class="tab-content">
                <div class="card">
                    <h3>üìà Daily Validation Requirements by Price Target</h3>
                    <div class="alert-box alert-info">
                        <strong>üí° Utility Scaling (1:1):</strong> Price must grow proportionally with validation volume. Higher prices require more network activity to be sustainable.
                    </div>
                    <div id="validationsChart" class="chart-container"></div>
                </div>
            </div>

            <div id="runway" class="tab-content">
                <div class="card">
                    <h3>üí∞ Treasury Runway & Death Cross Analysis</h3>
                    <div class="alert-box alert-success">
                        <strong>‚úÖ Transition to Buybacks:</strong> Team wallet depletes as validator rewards are paid. Higher prices = fewer validations needed but FASTER treasury depletion. <strong style="color: #28a745;">After exhaustion, network transitions to market buybacks - creating constant buy pressure and deflationary mechanism!</strong>
                    </div>
                    <div id="runwayChart" class="chart-container"></div>
                </div>
            </div>

            <div id="cliffEvents" class="tab-content">
                <div class="card">
                    <h3>‚ö†Ô∏è 2026 Cliff Events Timeline</h3>
                    <div class="alert-box alert-danger">
                        <strong>üö® ACTUAL PAYOUTS:</strong> Summer 2026 (Jul-Aug) represents the LARGEST cliff event with 40.9% of annual MNW rewards maturing simultaneously. Numbers shown are ACTUAL payouts based on current validation rate. At 10x growth, Summer 2026 cliff alone would EXCEED the entire team wallet!
                    </div>
                    <div id="cliffEventsChart" class="chart-container"></div>
                    <div class="cliff-info-boxes" id="cliffInfoBoxes"></div>
                </div>
            </div>

            <div id="buyback" class="tab-content">
                <div class="card">
                    <h3>üí∏ Daily Buyback Pressure After Treasury Depletion</h3>
                    <div class="alert-box alert-success">
                        <strong>üìä Market Impact:</strong> Shows required daily USD buy-wall to support validator rewards at each price level after team wallet is empty. This creates constant buy pressure = deflationary mechanism!
                    </div>
                    <div id="buybackChart" class="chart-container"></div>
                </div>
            </div>

            <div id="velocityTab" class="tab-content">
                <div class="card">
                    <h3>üîÑ How Velocity Impacts Required Validations</h3>
                    <div class="alert-box alert-info">
                        <strong>üí° MV=PQ Analysis:</strong> Current setting: <span id="velocityInfo">2.5x</span>. Lower velocity (strong HODLing) = less market cap needed for same price. Validators who compound/restake reduce sell pressure!
                    </div>
                    <div id="velocityChart" class="chart-container"></div>
                </div>
            </div>

            <div class="card">
<h3>üåê Network Status (After Scenario Adjustments)</h3>
                <div class="info-grid">
                    <div class="info-item" style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border: 2px solid #2196f3;">
                        <strong id="displayTotalNodes" style="color: #1976d2;">~</strong>
                        <span style="font-weight: 600; color: #1976d2;">Active Nodes üñ•Ô∏è</span>
                    </div>
                    <div class="info-item" style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border: 2px solid #2196f3;">
                        <strong id="displayActiveValidators" style="color: #1976d2;">~</strong>
                        <span style="font-weight: 600; color: #1976d2;">Active Validators üë•</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>üíº Node Operator Economics & Multi-Node Strategy</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <strong id="annualRewardsPerNode">~</strong>
                        <span>Annual Rewards (Per Node)</span>
                    </div>
                    <div class="info-item" style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border: 2px solid #4caf50;">
                        <strong id="tokenYield" style="color: #2e7d32;">~</strong>
                        <span style="font-weight: 600; color: #2e7d32;">Token Yield (APY) üåü</span>
                    </div>
                    <div class="info-item">
                        <strong id="breakEvenPrice">~</strong>
                        <span>Break-Even Price (Single Node)</span>
                    </div>
                    <div class="info-item">
                        <strong id="singleNodeROI">~</strong>
                        <span>Single Node Net Profit & ROI</span>
                    </div>
                    <div class="info-item">
                        <strong id="minNodesToBreakEven">~</strong>
                        <span>Min Nodes to Break Even</span>
                    </div>
                </div>
                
                <div class="alert-box alert-warning" style="margin-top: 20px;">
                    <strong>üî• Economies of Scale:</strong> VPS Cost is $6/month (‚â§100 nodes) or $24/month (101+ nodes). Spreading this across multiple nodes dramatically improves profitability!
                </div>
                
                <div style="background: linear-gradient(135deg, #e7f3ff 0%, #d4e9ff 100%); padding: 20px; border-radius: 10px; border-left: 4px solid #0066cc; margin-top: 20px;">
                    <h4 style="color: #0066cc; margin: 0 0 15px 0; font-size: 1.2em;">üõ°Ô∏è EVLS Protection System (Effective Validator Load Score)</h4>
                    <p style="margin: 0 0 15px 0; line-height: 1.6;">
                        EVLS prevents validator monopolization by applying <strong>penalties to validators running 101+ nodes</strong>. Combined with VPS cost structure (jumps 4x at 101 nodes), this creates clear economic incentives for decentralization.
                    </p>
                    
                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; border-left: 4px solid #ffc107; margin-bottom: 15px;">
                        <h5 style="margin: 0 0 10px 0; color: #856404;">‚≠ê CRITICAL ECONOMIC THRESHOLDS:</h5>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px;">
                            <div>
                                <strong style="color: #28a745;" id="optimalNodesText">‚úÖ Calculating optimal configuration...</strong>
                                <div style="font-size: 0.9em; margin-top: 5px;">$6/month VPS, no EVLS penalty</div>
                                <div style="font-size: 0.85em; color: #6c757d;">75 = peak ROI (6.0%), 100 = max cheap VPS</div>
                            </div>
                            <div>
                                <strong style="color: #dc3545;">üö® 101+ Nodes = DUAL PENALTY STARTS</strong>
                                <div style="font-size: 0.9em; margin-top: 5px;">VPS jumps 4x ($72‚Üí$288) + EVLS penalty begins</div>
                                <div style="font-size: 0.85em; color: #6c757d;">Double penalty: expensive VPS + reduced rewards</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <div style="font-weight: bold; color: #28a745;">‚úÖ 1-100 Nodes</div>
                            <div style="font-size: 0.9em; margin-top: 5px;">$6/month VPS, No EVLS penalty</div>
                            <div style="font-size: 0.85em; color: #6c757d;">Optimal zone (peak at 75-100)</div>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <div style="font-weight: bold; color: #fd7e14;">‚ö†Ô∏è 101-250 Nodes</div>
                            <div style="font-size: 0.9em; margin-top: 5px;">$24/month VPS + 0-34% EVLS</div>
                            <div style="font-size: 0.85em; color: #6c757d;">Dual penalty: cost + rewards</div>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <div style="font-weight: bold; color: #dc3545;">üö® 250-500 Nodes</div>
                            <div style="font-size: 0.9em; margin-top: 5px;">34-65% EVLS penalty</div>
                            <div style="font-size: 0.85em; color: #6c757d;">Significant reduction</div>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <div style="font-weight: bold; color: #dc3545;">üö® 500-1000 Nodes</div>
                            <div style="font-size: 0.9em; margin-top: 5px;">65-80% EVLS penalty</div>
                            <div style="font-size: 0.85em; color: #6c757d;">Severe reduction</div>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <div style="font-weight: bold; color: #dc3545;">üö´ 1000+ Nodes</div>
                            <div style="font-size: 0.9em; margin-top: 5px;">~80%+ EVLS penalty</div>
                            <div style="font-size: 0.85em; color: #6c757d;">Monopolization unfeasible</div>
                        </div>
                    </div>
                    <p style="margin: 15px 0 0 0; font-size: 0.95em; color: #0066cc; font-weight: 600;">
                        üí° Example: 1000 nodes gets 80% EVLS penalty = same total validations as 200 nodes without penalty. Combined with expensive VPS, ROI drops to ~1%!
                    </p>
                </div>
                
                <!-- NEW v5.5: My Nodes Calculator -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 10px; margin-top: 20px; color: white;">
                    <h4 style="margin: 0 0 15px 0; font-size: 1.3em;">üéØ My Nodes Calculator</h4>
                    <p style="margin: 0 0 15px 0; opacity: 0.95;">Calculate economics for YOUR specific node count</p>
                    
                    <!-- Number of Nodes -->
                    <div style="padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                        <label style="font-weight: bold; display: block; margin-bottom: 10px;">Number of Nodes:</label>
                        <div style="display: grid; grid-template-columns: 150px 1fr; gap: 20px; align-items: center;">
                            <div>
                                <input type="number" id="myNodesInput" value="1" min="1" max="1000" 
                                       style="width: 100%; padding: 8px; font-size: 1em; font-weight: bold; border-radius: 5px; border: 2px solid white; text-align: center;"
                                       oninput="document.getElementById('myNodesSlider').value = this.value; document.getElementById('myNodesSliderValue').textContent = this.value + ' node' + (this.value == 1 ? '' : 's'); calculateMyNodes()">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-size: 0.9em;">Adjust with Slider:</label>
                                <input type="range" id="myNodesSlider" min="1" max="1000" value="1" 
                                       style="width: 100%;"
                                       oninput="document.getElementById('myNodesInput').value = this.value; document.getElementById('myNodesSliderValue').textContent = this.value + (this.value == 1 ? ' node' : ' nodes'); calculateMyNodes()">
                                <div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-top: 3px; opacity: 0.85;">
                                    <span>1 node</span>
                                    <span id="myNodesSliderValue" style="font-weight: bold;">1 node</span>
                                    <span>1,000 nodes</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Network Size Override -->
                    <div style="margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                        <label style="font-weight: bold; display: block; margin-bottom: 10px;">üåê Network Size (for modeling):</label>
                        <div style="display: grid; grid-template-columns: 150px 1fr 120px; gap: 15px; align-items: center;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-size: 0.9em;">Active Nodes:</label>
                                <input type="number" id="myNetworkNodes" value="4339" min="1000" max="20000" 
                                       style="width: 100%; padding: 8px; font-size: 1em; font-weight: bold; border-radius: 5px; border: 2px solid white; text-align: center;"
                                       oninput="document.getElementById('myNetworkSlider').value = this.value; updateMyNetworkValidators(); calculateMyNodes()">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-size: 0.9em;">Adjust Network Size:</label>
                                <input type="range" id="myNetworkSlider" min="1000" max="20000" value="4339" step="100"
                                       style="width: 100%;"
                                       oninput="document.getElementById('myNetworkNodes').value = this.value; updateMyNetworkValidators(); calculateMyNodes()">
                                <div style="display: flex; justify-content: space-between; font-size: 0.75em; margin-top: 3px; opacity: 0.85;">
                                    <span>1K nodes</span>
                                    <span id="myNetworkSliderValue">4,339 nodes</span>
                                    <span>20K nodes</span>
                                </div>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-size: 0.9em;">Validators:</label>
                                <div id="myNetworkValidators" style="padding: 8px; font-size: 1em; font-weight: bold; background: rgba(255,255,255,0.2); border-radius: 5px; text-align: center;">108</div>
                            </div>
                        </div>
                        <div style="font-size: 0.85em; margin-top: 8px; opacity: 0.9;">
                            üí° Model different network sizes to see how your profitability changes as the network grows
                        </div>
                    </div>
                    
                    <!-- VPS Configuration -->
                    <div style="margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                        <label style="font-weight: bold; display: block; margin-bottom: 10px;">üñ•Ô∏è Number of VPS:</label>
                        <div style="display: grid; grid-template-columns: 150px 1fr; gap: 15px; align-items: center;">
                            <div>
                                <input type="number" id="myVPSCount" value="1" min="1" max="100"
                                       style="width: 100%; padding: 8px; font-size: 1em; font-weight: bold; border-radius: 5px; border: 2px solid white; text-align: center;"
                                       oninput="calculateMyNodes()">
                                <div style="font-size: 0.8em; margin-top: 5px; opacity: 0.85;">How many servers you use</div>
                            </div>
                            <div style="font-size: 0.85em; opacity: 0.9; line-height: 1.5;">
                                üí° Multiple nodes can share one VPS. Typical: 1-100 nodes = 1 VPS ($72/yr), 101+ nodes = 1 VPS ($288/yr).
                            </div>
                        </div>
                    </div>
                    
                    <!-- My Nodes Results -->
                    <div id="myNodesResults" style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.15); border-radius: 8px;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                            <div>
                                <div style="font-size: 0.85em; opacity: 0.9;">Daily Validations</div>
                                <div id="myNodesDailyVals" style="font-size: 1.5em; font-weight: bold;">0</div>
                            </div>
                            <div>
                                <div style="font-size: 0.85em; opacity: 0.9;">Yearly Validations</div>
                                <div id="myNodesYearlyVals" style="font-size: 1.5em; font-weight: bold;">0</div>
                            </div>
                            <div>
                                <div style="font-size: 0.85em; opacity: 0.9;">EVLS Penalty</div>
                                <div id="myNodesEVLS" style="font-size: 1.5em; font-weight: bold;">0%</div>
                            </div>
                            <div>
                                <div style="font-size: 0.85em; opacity: 0.9;">Token Yield</div>
                                <div id="myNodesTokenYield" style="font-size: 1.5em; font-weight: bold;">8.65%</div>
                            </div>
                            <div>
                                <div style="font-size: 0.85em; opacity: 0.9;">Annual Profit</div>
                                <div id="myNodesProfit" style="font-size: 1.5em; font-weight: bold;">$---</div>
                            </div>
                            <div>
                                <div style="font-size: 0.85em; opacity: 0.9;">ROI</div>
                                <div id="myNodesROI" style="font-size: 1.5em; font-weight: bold;">---%</div>
                            </div>
                            <div>
                                <div style="font-size: 0.85em; opacity: 0.9;">Total VPS Cost</div>
                                <div id="myNodesVPS" style="font-size: 1.5em; font-weight: bold;">$72/yr √ó 1</div>
                            </div>
                            <div>
                                <div style="font-size: 0.85em; opacity: 0.9;">Total Staked</div>
                                <div id="myNodesStaked" style="font-size: 1.5em; font-weight: bold;">61.2K MNW</div>
                            </div>
                        </div>
                        <!-- Network Percentage Display -->
                        <div style="margin-top: 15px; padding: 12px; background: rgba(255,255,255,0.2); border-radius: 8px; text-align: center; border: 2px solid rgba(255,255,255,0.3);">
                            <div style="font-size: 0.85em; opacity: 0.95; margin-bottom: 5px; font-weight: 600;">üìä Your Network Share</div>
                            <div id="myNodesNetworkInfo" style="font-size: 1.2em; font-weight: bold; line-height: 1.5;">
                                <span id="myNodesCount">1</span> <span id="myNodesLabel">node</span> = <span id="myNodesPercentage" style="color: #4ade80;">0.02%</span> of <span id="myNodesNetworkSize">4,339</span> active nodes
                            </div>
                        </div>
                    </div>
                </div>
                
                <h4 style="margin-top: 20px; color: #667eea;">Multi-Node VPS Strategy</h4>
                <table style="margin-top: 15px;">
                    <thead>
                        <tr>
                            <th>Configuration</th>
                            <th style="text-align: right;">Nodes</th>
                            <th style="text-align: right;">AVG Val/Day</th>
                            <th style="text-align: right;">Yearly Validations</th>
                            <th style="text-align: right;">Yearly MNW</th>
                            <th style="text-align: right;">VPS $/Node/Yr</th>
                            <th style="text-align: right;">EVLS</th>
                            <th style="text-align: right;">EVLS %</th>
                            <th style="text-align: right;">EVLS Loss ($)</th>
                            <th style="text-align: right;">Annual $</th>
                            <th style="text-align: right;">Yield %</th>
                            <th style="text-align: right;">ROI %</th>
                        </tr>
                    </thead>
                    <tbody id="multiNodeTable"></tbody>
                </table>
                
                <div class="alert-box alert-success" style="margin-top: 15px;" id="multiNodeInsight"></div>
                <div class="evls-warning" id="evlsWarning" style="display: none;">
                    <strong>‚ö†Ô∏è EVLS Active:</strong> Yellow/red highlighted rows show configurations with EVLS penalties (100+ nodes). v1.0.1 uses CORRECTED linear model: 10.26% penalty at 100 nodes, +0.28%/node. Based on 20 real validators with 12-month stakes (Aug 2025 - Jan 2026). Baseline: 4.97 val/node/day.
                </div>
                <div style="margin: 15px 0; padding: 15px; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); border-left: 4px solid #1e40af; border-radius: 8px; color: white;">
                    <strong>üîÑ Buyback Mechanism:</strong> Team Wallet operates on a circular model (no burning). When empty, buybacks occur from market, creating temporary buy pressure. Tokens return to circulation through operations. Price cycles expected: buyback periods (upward) followed by spending periods (downward).
                </div>
            </div>

            <div class="overhang-box" id="liquidity-tiers">
                <h4 style="margin-bottom: 20px;">‚ö†Ô∏è Liquidity Tiers: Market Overhang Analysis</h4>
                
                <!-- Tier 1: Immediate Liquidity (Red - Highest Risk) -->
                <div style="background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%); padding: 15px; border-radius: 8px; border-left: 4px solid #990000; margin-bottom: 15px;">
                    <h5 style="color: #ffffff; margin: 0 0 10px 0; font-size: 14px; font-weight: bold;">üî¥ Tier 1: Immediate Liquidity (Can Sell Today)</h5>
                    <div class="info-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                        <div class="info-item" style="background: white; padding: 12px;">
                            <strong style="color: #cc0000;" id="tier1DexLiquidity">1.07M</strong>
                            <span style="font-size: 12px;">DEX Liquidity</span>
                        </div>
                        <div class="info-item" style="background: white; padding: 12px;">
                            <strong style="color: #cc0000;" id="tier1EthereumWallets">28.68M</strong>
                            <span style="font-size: 12px;">Ethereum Wallets</span>
                        </div>
                        <div class="info-item" style="background: white; padding: 12px;">
                            <strong style="color: #cc0000;" id="tier1PolygonWallets">2.15M</strong>
                            <span style="font-size: 12px;">Polygon Wallets</span>
                        </div>
                        <div class="info-item" style="background: white; padding: 12px; border: 2px solid #cc0000;">
                            <strong style="color: #cc0000; font-size: 18px;" id="tier1Total">31.90M</strong>
                            <span style="font-size: 12px; font-weight: 600;">Tier 1 Total</span>
                        </div>
                    </div>
                    <p style="margin: 10px 0 0 0; font-size: 12px; color: #ffffff; font-weight: 500;">Can be sold immediately on DEX or bridged to Ethereum (10-30 min)</p>
                </div>

                <!-- Tier 2: Risk Overhang (Orange - High Risk) -->
                <div style="background: linear-gradient(135deg, #ff8800 0%, #ff6600 100%); padding: 15px; border-radius: 8px; border-left: 4px solid #cc5500; margin-bottom: 15px;">
                    <h5 style="color: #ffffff; margin: 0 0 10px 0; font-size: 14px; font-weight: bold;">üü† Tier 2: Risk Overhang (Unpredictable Timing)</h5>
                    <div class="info-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                        <div class="info-item" style="background: white; padding: 12px;">
                            <strong style="color: #ff6600;">3.38M</strong>
                            <span style="font-size: 12px;">KuCoin Locked</span>
                        </div>
                        <div class="info-item" style="background: white; padding: 12px; border: 2px solid #ff6600;">
                            <strong style="color: #ff6600; font-size: 18px;">3.38M</strong>
                            <span style="font-size: 12px; font-weight: 600;">Tier 2 Total</span>
                        </div>
                    </div>
                    <p style="margin: 10px 0 0 0; font-size: 12px; color: #ffffff; font-weight: 500;">‚ö†Ô∏è Confiscated by exchange - can be dumped anytime without warning</p>
                </div>

                <!-- Tier 3: Protocol Locked (Blue - Medium Risk) -->
                <div style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); padding: 15px; border-radius: 8px; border-left: 4px solid #1e40af; margin-bottom: 15px;">
                    <h5 style="color: #ffffff; margin: 0 0 10px 0; font-size: 14px; font-weight: bold;">üîµ Tier 3: Protocol Locked (Predictable Unlock)</h5>
                    <div class="info-grid" style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 10px;">
                        <div class="info-item" style="background: white; padding: 12px;">
                            <strong style="color: #2563eb;" id="stake12m">Loading...</strong>
                            <span style="font-size: 12px;">12-Month Stakes</span>
                        </div>
                        <div class="info-item" style="background: white; padding: 12px;">
                            <strong style="color: #2563eb;" id="stake6m">Loading...</strong>
                            <span style="font-size: 12px;">6-Month Stakes</span>
                        </div>
                        <div class="info-item" style="background: white; padding: 12px;">
                            <strong style="color: #2563eb;" id="stake3m">Loading...</strong>
                            <span style="font-size: 12px;">3-Month Stakes</span>
                        </div>
                        <div class="info-item" style="background: white; padding: 12px; border: 2px solid #2563eb;">
                            <strong style="color: #2563eb; font-size: 18px;" id="tier3Total">Loading...</strong>
                            <span style="font-size: 12px; font-weight: 600;">Tier 3 Total</span>
                        </div>
                    </div>
                    <p style="margin: 10px 0 0 0; font-size: 12px; color: #ffffff; font-weight: 500;">Validator stakes with known unlock dates - becomes Tier 1 after unlock</p>
                </div>

                <!-- Lost/Inaccessible (Gray) -->
                <div style="background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%); padding: 15px; border-radius: 8px; border-left: 4px solid #374151; margin-bottom: 15px;">
                    <h5 style="color: #ffffff; margin: 0 0 10px 0; font-size: 14px; font-weight: bold;">‚ö´ Permanently Lost/Inaccessible</h5>
                    <div class="info-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                        <div class="info-item" style="background: white; padding: 12px;">
                            <strong style="color: #4b5563;" id="lostMNW">Loading...</strong>
                            <span style="font-size: 12px;">Lost Wallets</span>
                        </div>
                        <div class="info-item" style="background: white; padding: 12px;">
                            <strong style="color: #4b5563; font-size: 18px;" id="totalLostDisplay">Loading...</strong>
                            <span style="font-size: 12px; font-weight: 600;">Total Lost</span>
                        </div>
                    </div>
                    <p style="margin: 10px 0 0 0; font-size: 12px; color: #ffffff; font-weight: 500;">Lost keys or permanently inaccessible - reduces effective supply</p>
                    
                    <!-- Detailed Explanation Box -->
                    <div style="background: rgba(255, 255, 255, 0.95); padding: 12px; border-radius: 6px; margin-top: 10px; font-size: 12px; line-height: 1.6; color: #374151; border-left: 4px solid #ef4444;">
                        <div style="font-weight: 600; margin-bottom: 8px; color: #dc2626; font-size: 13px;">üìã What Constitutes "Lost" Tokens?</div>
                        
                        <div style="margin-bottom: 8px;">
                            <strong style="color: #6b7280;">üîë Lost Private Keys:</strong><br>
                            Wallets where owners have lost access to their private keys/seed phrases. Without the key, the MNW is permanently locked - the blockchain shows the balance but no one can ever move it.
                        </div>
                        
                        <div style="margin-bottom: 8px;">
                            <strong style="color: #6b7280;">üíÄ Deceased Holders:</strong><br>
                            Tokens held by individuals who have passed away without sharing wallet access. Unless heirs have the private keys, these tokens are effectively lost forever.
                        </div>
                        
                        <div style="margin-bottom: 8px;">
                            <strong style="color: #6b7280;">ü™¶ Abandoned Wallets:</strong><br>
                            Very old wallets (2+ years inactive) with small balances that owners likely forgot about or consider worthless. Often from early airdrops or test transactions.
                        </div>
                        
                        <div style="padding-top: 8px; border-top: 1px solid #d1d5db; margin-top: 8px;">
                            <strong style="color: #dc2626;">üí° Why This Matters:</strong><br>
                            Lost tokens are <strong>permanently removed from effective supply</strong>. They still show in total supply but can never be sold, staked, or used. This makes MNW more scarce than the total supply number suggests.
                        </div>
                        
                        <div style="padding-top: 8px; margin-top: 8px; font-size: 11px; font-style: italic; color: #6b7280;">
                            <strong>Estimation Method:</strong> The ~0.5M estimate is conservative, based on analysis of long-dormant wallet activity patterns. The real number could be higher as many lost keys are indistinguishable from HODLed tokens.
                        </div>
                    </div>
                </div>

                <!-- Summary -->
                <div style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); padding: 15px; border-radius: 8px; border: 2px solid #3b82f6;">
                    <div class="info-grid" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
                        <div class="info-item" style="background: white; padding: 12px;">
                            <strong style="color: #1e40af; font-size: 20px;" id="totalLiquid">35.28M</strong>
                            <span style="font-size: 12px; font-weight: 600;">Total Liquid (T1+T2)</span>
                        </div>
                        <div class="info-item" style="background: white; padding: 12px;">
                            <strong style="color: #1e40af; font-size: 20px;" id="totalOverhang">48.08M</strong>
                            <span style="font-size: 12px; font-weight: 600;">Total Overhang (T1+T2+T3)</span>
                        </div>
                        <div class="info-item" style="background: white; padding: 12px;">
                            <strong style="color: #059669; font-size: 20px;" id="effectiveSupply">~47.58M</strong>
                            <span style="font-size: 12px; font-weight: 600;">Effective Supply</span>
                        </div>
                    </div>
                    <p style="margin: 15px 0 0 0; text-align: center; font-weight: 600; font-size: 14px; color: #1e40af;" id="overhangPercent">73% of total supply is liquid or could become liquid</p>
                </div>
            </div>
        </div>

        <footer style="text-align: center; padding: 20px; color: #6c757d; border-top: 2px solid #e9ecef;">
            <p>Unofficial Trust.Supply Economic Dashboard v1.0.1 | Updated 19 January 2026</p>
            <p style="font-size: 0.85em; margin-top: 5px;">Community tool by @trippledutch | v1.0.1: Multi-tier liquidity analysis, dynamic ROI</p>
        </footer>
    </div>

    <script>
        function parseFormattedNumber(str) {
            if (typeof str === 'number') return str;
            if (typeof str === 'string') return parseFloat(str.replace(/,/g, '')) || 0;
            return 0;
        }

        function formatNumber(num) {
            return num.toLocaleString(undefined, {maximumFractionDigits: 0});
        }

        function formatCompactNumber(num) {
            if (num >= 1e9) return '$' + (num / 1e9).toFixed(2) + 'B';
            if (num >= 1e6) return '$' + (num / 1e6).toFixed(2) + 'M';
            if (num >= 1e3) return '$' + (num / 1e3).toFixed(0) + 'K';
            return '$' + num.toFixed(0);
        }

        function formatCompactMNW(num) {
            if (num >= 1e9) return (num / 1e9).toFixed(2) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(2) + 'M';
            if (num >= 1e3) return (num / 1e3).toFixed(1) + 'K';
            return formatNumber(num);
        }

        function calculateEVLSFactor(nodes) {
            // EVLS (Effective Validator Load Score) penalty for large validators
            // v5.6.1 EXACT MODEL from 12-month stake data
            // Baseline: 4.9662 val/node/day (<100 nodes)
            // At 100 nodes: 10.26% penalty (actual: 4.457 val/node/day)
            // At 221 nodes: 44.02% penalty (actual: 2.78 val/node/day)
            // Linear slope: 0.2790% per node
            if (nodes < 100) {
                return 1.0;  // No EVLS penalty below 100 nodes
            } else {
                // Linear penalty: EVLS% = 10.26 + 0.2790 √ó (nodes - 100)
                const penaltyPercent = 10.26 + (0.2790 * (nodes - 100));
                const evlsFactor = 1.0 - (penaltyPercent / 100.0);
                return Math.max(0.15, evlsFactor);  // Cap at 85% maximum penalty
            }
        }

        function updateCalculatedFields() {
            const totalNodes = parseFormattedNumber(document.getElementById('totalNodes').value);
            const stakePerNode = parseFormattedNumber(document.getElementById('stakePerNode').value);
            const totalStaked = totalNodes * stakePerNode;
            document.getElementById('totalStaked').value = formatNumber(totalStaked);
        }

        function updateYearlyValidations() {
            const dailyValidations = parseFormattedNumber(document.getElementById('dailyValidations').value);
            const yearlyValidations = dailyValidations * 365;
            document.getElementById('yearlyValidations').value = formatNumber(yearlyValidations);
        }

        function updatePriceScaling() {
            const dailyValidations = parseFormattedNumber(document.getElementById('dailyValidations').value);
            const baselineDailyVals = 17900;
            const baselinePrice = 0.062;
            
            // Price scales proportionally with validation growth (1:1 ratio for utility scaling)
            const validationMultiplier = dailyValidations / baselineDailyVals;
            const expectedPrice = baselinePrice * validationMultiplier;
            
            // Update price field
            document.getElementById('currentPrice').value = expectedPrice.toFixed(5);
        }

        // NEW v5.5: Update network display boxes to match input values
        function updateNetworkDisplays() {
            const totalNodes = document.getElementById('totalNodes').value;
            const activeValidators = document.getElementById('activeValidators').value;
            
            document.getElementById('displayTotalNodes').textContent = formatNumber(parseFormattedNumber(totalNodes));
            document.getElementById('displayActiveValidators').textContent = formatNumber(parseFormattedNumber(activeValidators));
        }

        // NEW v1.0.1: Update My Nodes Calculator Active Nodes when main Active Nodes changes
        function updateMyNodesActiveNodes() {
            const totalNodes = parseFormattedNumber(document.getElementById('totalNodes').value);
            document.getElementById('myNetworkNodes').value = totalNodes;
            calculateMyNodes(); // Recalculate with new network size
        }

        // NEW v5.5: Update nodes when Daily Validations is manually changed
        function updateNodesFromValidations() {
            const dailyValidations = parseFormattedNumber(document.getElementById('dailyValidations').value);
            const baselineDailyVals = 17900;
            const baselineTotalNodes = 4335;
            const baselineValidators = 108;
            const MAX_NODES = 20000;
            
            // Calculate multiplier from validation change
            const multiplier = dailyValidations / baselineDailyVals;
            
            // Scale nodes and validators
            let newTotalNodes = Math.round(baselineTotalNodes * multiplier);
            let newValidators = Math.round(baselineValidators * multiplier);
            
            // Apply 20,000 node cap
            if (newTotalNodes > MAX_NODES) {
                newTotalNodes = MAX_NODES;
                const nodeValidatorRatio = baselineTotalNodes / baselineValidators;
                newValidators = Math.round(MAX_NODES / nodeValidatorRatio);
            }
            
            document.getElementById('totalNodes').value = formatNumber(newTotalNodes);
            document.getElementById('activeValidators').value = newValidators;
            
            // Update display boxes
            document.getElementById('displayTotalNodes').textContent = formatNumber(newTotalNodes);
            document.getElementById('displayActiveValidators').textContent = formatNumber(newValidators);
            
            // Update calculated fields
            updateCalculatedFields();
        }
        
        // v1.0.1: Update My Network Active Nodes when Daily Validations changes
        function updateActiveNodesFromValidations() {
            const dailyValidations = parseFormattedNumber(document.getElementById('dailyValidations').value);
            const baselineDailyVals = 17900;
            const baselineTotalNodes = 4339;  // Default for My Network
            const baselineValidators = 108;
            
            // Calculate new active nodes based on validations
            const multiplier = dailyValidations / baselineDailyVals;
            const newActiveNodes = Math.round(baselineTotalNodes * multiplier);
            const newValidators = Math.round(baselineValidators * multiplier);
            
            // Update My Network Active Nodes field
            document.getElementById('myNetworkNodes').value = newActiveNodes;
            document.getElementById('myNetworkSlider').value = newActiveNodes;
            
            // v1.0.1: Also update the main Network Size display box
            document.getElementById('totalNodes').value = formatNumber(newActiveNodes);
            document.getElementById('activeValidators').value = newValidators;
            document.getElementById('displayTotalNodes').textContent = formatNumber(newActiveNodes);
            document.getElementById('displayActiveValidators').textContent = formatNumber(newValidators);
            
            // Update calculated fields
            updateCalculatedFields();
            
            // Refresh My Nodes Calculator with new network size
            calculateMyNodes();
        }

        // NEW v5.5: Transaction Growth Multiplier
        function updateTransactionMultiplier() {
            const multiplier = parseFloat(document.getElementById('transactionMultiplier').value);
            document.getElementById('transactionMultiplierValue').textContent = multiplier.toFixed(1) + 'x';
            
            // Update daily validations based on multiplier
            const baselineDailyVals = 17900; // The default baseline
            const newDailyVals = Math.round(baselineDailyVals * multiplier);
            document.getElementById('dailyValidations').value = formatNumber(newDailyVals);
            
            // NEW v5.5: Scale network nodes and validators proportionally
            const baselineTotalNodes = 4335;
            const baselineValidators = 108;
            const MAX_NODES = 20000; // Hard constraint
            
            let newTotalNodes = Math.round(baselineTotalNodes * multiplier);
            let newValidators = Math.round(baselineValidators * multiplier);
            
            // Apply 20,000 node cap
            if (newTotalNodes > MAX_NODES) {
                newTotalNodes = MAX_NODES;
                // Maintain node:validator ratio even at cap
                const nodeValidatorRatio = baselineTotalNodes / baselineValidators;
                newValidators = Math.round(MAX_NODES / nodeValidatorRatio);
            }
            
            document.getElementById('totalNodes').value = formatNumber(newTotalNodes);
            document.getElementById('activeValidators').value = newValidators;
            
            // Update display boxes to match input boxes exactly
            document.getElementById('displayTotalNodes').textContent = formatNumber(newTotalNodes);
            document.getElementById('displayActiveValidators').textContent = formatNumber(newValidators);
            
            // Update calculated fields (total staked)
            updateCalculatedFields();
            
            // Update yearly validations
            updateYearlyValidations();
            
            // Update price proportionally with transaction growth
            updatePriceScaling();
            
            // Recalculate everything
            calculate();
        }

        // NEW v5.5: Price Override Multiplier
        function updatePriceMultiplier() {
            const multiplier = parseFloat(document.getElementById('priceMultiplier').value);
            document.getElementById('priceMultiplierValue').textContent = multiplier.toFixed(1) + 'x';
            
            // Get current price from the transaction-adjusted baseline
            const dailyValidations = parseFormattedNumber(document.getElementById('dailyValidations').value);
            const baselineDailyVals = 17900;
            const baselinePrice = 0.062;
            
            // Calculate what price should be based on transactions alone
            const transactionBasedPrice = baselinePrice * (dailyValidations / baselineDailyVals);
            
            // Apply the independent price multiplier
            const overridePrice = transactionBasedPrice * multiplier;
            document.getElementById('currentPrice').value = overridePrice.toFixed(5);
            
            // Recalculate everything
            calculate();
        }

        // NEW: Add CoinGecko price function
        async function fetchMNWPrice() {
            const res = await fetch(
                'https://api.coingecko.com/api/v3/simple/price?ids=morpheus-network&vs_currencies=usd',
                { cache: 'no-store' }
            );

            if (!res.ok) {
                throw new Error('Failed to fetch MNW price from CoinGecko');
            }

            const priceData = await res.json();
            return priceData['morpheus-network'].usd;
        }

        async function fetchActiveNodesFromAlchemy() {
            const ALCHEMY_URL =
                'https://polygon-mainnet.g.alchemy.com/v2/dPG-8rulN-Hn_xyJ9v1Z6HNALOxScwSY';

            const MNW_TOKEN = '0x3c59798620e5fec0ae6df1a19c6454094572ab92';
            const WALLET = '0xf994b03d2793788a3ed86eabe792963620bae2c6';

            const payload = {
                jsonrpc: '2.0',
                id: 1,
                method: 'alchemy_getTokenBalances',
                params: [WALLET, [MNW_TOKEN]]
            };

            const res = await fetch(ALCHEMY_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!res.ok) throw new Error('Alchemy API error');

            const json = await res.json();
            const hexBalance = json.result.tokenBalances[0].tokenBalance;

            if (!hexBalance) throw new Error('No MNW balance returned');

            const mnw = parseInt(hexBalance, 16) / 1e18;
            const nodes = Math.floor(mnw / 1800);

            console.log('MNW balance:', mnw, '‚Üí active nodes:', nodes);
            return nodes;
        }
            


        // NEW v5.5: Reset sliders to default values
        // NEW: Load latest data

async function loadLatestData(event) {

    console.log('loadLatestData FINAL', new Date().toISOString());

    const statusDiv = document.getElementById('updateStatus');
    const button = event.currentTarget;
    const originalText = button.innerHTML;

    try {
        // UI: loading state
        button.innerHTML = '‚è≥ Loading...';
        button.disabled = true;

        // 1Ô∏è‚É£ Fetch JSON (cache-busted)
        const response = await fetch(
            `https://raw.githubusercontent.com/trippledutch/trust-supply-dashboard/main/dashboard-data.json?v=${Date.now()}`,
            { cache: 'no-store' }
        );

        if (!response.ok) {
            throw new Error(`HTTP Error ${response.status}`);
        }

        const jsonData = await response.json();
        const data = jsonData.data;

        // Load ACTIVE NODES from JSON (default failback)
        if (data.activeNodes !== undefined) {
            document.getElementById('totalNodes').value = formatNumber(data.activeNodes);
            document.getElementById('myNetworkNodes').value = data.activeNodes;
            document.getElementById('myNetworkSlider').value = data.activeNodes;
         }


        // üîπ Live ACTIVE NODES override (from wallet via Alchemy)
        try {
            const liveNodes = await fetchActiveNodesFromAlchemy();

            document.getElementById('totalNodes').value = formatNumber(liveNodes);
            document.getElementById('myNetworkNodes').value = liveNodes;
            document.getElementById('myNetworkSlider').value = liveNodes;

            updateMyNetworkValidators();
        } catch (e) {
            console.warn('Live node fetch failed, using JSON fallback', e);
        }

        if (data.activeValidators !== undefined)
            document.getElementById('activeValidators').value = data.activeValidators;

        if (data.dailyValidations !== undefined)
            document.getElementById('dailyValidations').value = formatNumber(data.dailyValidations);

        if (data.dexLiquidity !== undefined)
            document.getElementById('dexLiquidity').value = formatNumber(data.dexLiquidity);

        if (data.cexLocked !== undefined)
            document.getElementById('cexLocked').value = formatNumber(data.cexLocked);

        if (data.teamWallet !== undefined)
            document.getElementById('teamWallet').value = formatNumber(data.teamWallet);

        if (data.polygonMNW !== undefined)
            document.getElementById('polygonMNW').value = formatNumber(data.polygonMNW);

        if (data.ethereumMNW !== undefined)
            document.getElementById('ethereumMNW').value = formatNumber(data.ethereumMNW);

        if (data.lostTokens !== undefined)
            document.getElementById('lostTokens').value = formatNumber(data.lostTokens);

        if (data.nodes3m !== undefined)
            document.getElementById('nodes3m').value = formatNumber(data.nodes3m);

        if (data.nodes6m !== undefined)
            document.getElementById('nodes6m').value = formatNumber(data.nodes6m);

        if (data.nodes12m !== undefined)
            document.getElementById('nodes12m').value = formatNumber(data.nodes12m);

        if (data.reward3m !== undefined)
            document.getElementById('reward3m').value = data.reward3m;

        if (data.reward6m !== undefined)
            document.getElementById('reward6m').value = data.reward6m;

        if (data.reward12m !== undefined)
            document.getElementById('reward12m').value = data.reward12m;

        // 3Ô∏è‚É£ Live MNW price override (best-effort)
        try {
            const livePrice = await fetchMNWPrice();
            if (typeof livePrice === 'number' && !isNaN(livePrice)) {
                console.log('LIVE PRICE RECEIVED:', livePrice);
                document.getElementById('currentPrice').value = livePrice.toFixed(5);
            } else {
                throw new Error('Invalid live price');
            }
        } catch (e) {
            console.warn('Live price failed, keeping JSON price', e);
        }

        // 4Ô∏è‚É£ Recalculate derived values
        updateCalculatedFields();
        updateYearlyValidations();
        updateNetworkDisplays();
        calculate();
        calculateMyNodes();

        // 5Ô∏è‚É£ SINGLE success message (no overwrite)
        statusDiv.innerHTML =
            `<span style="color: #28a745;">‚úÖ Successfully loaded data from ${jsonData.lastUpdated || 'Unknown'}</span>`;

        // UI: restore button
        button.innerHTML = '‚úÖ Data Loaded!';
        setTimeout(() => {
            button.innerHTML = originalText;
            button.disabled = false;
        }, 2000);

    } catch (error) {
        console.error('Error loading data:', error);

        statusDiv.innerHTML =
            '<span style="color: #dc3545;">‚ùå Failed to load data. Check console (F12).</span>';

        button.innerHTML = '‚ùå Load Failed';
        setTimeout(() => {
            button.innerHTML = originalText;
            button.disabled = false;
        }, 2000);
    }
}



        // NEW v5.5: Update Network Validators based on node count
        function updateMyNetworkValidators() {
            const networkNodes = parseInt(document.getElementById('myNetworkNodes').value) || 4338;
            const baselineNodes = 4338;
            const baselineValidators = 108;
            const ratio = baselineNodes / baselineValidators; // ~40.17 nodes per validator
            
            const calculatedValidators = Math.round(networkNodes / ratio);
            
            document.getElementById('myNetworkValidators').textContent = calculatedValidators;
            document.getElementById('myNetworkSliderValue').textContent = formatNumber(networkNodes) + ' nodes';
        }

        // NEW v5.5: My Nodes Calculator
        function calculateMyNodes() {
            try {
                const nodes = parseInt(document.getElementById('myNodesInput').value) || 1;
                const stakePerNode = 1800;
                const currentPrice = parseFloat(document.getElementById('currentPrice').value) || 0.062;
                const dailyValidations = parseFormattedNumber(document.getElementById('dailyValidations').value) || 17900;
                
                // v1.0.1: Active Nodes - INVERSE relationship
                // More nodes = same validations split among more nodes = lower per-node share
                const networkNodes = parseInt(document.getElementById('myNetworkNodes').value) || 4339;
                const baselineNetworkNodes = 4339;
                
                // Calculate per-node baseline from network validations
                // If network has more nodes, each node gets LESS
                const validationsPerNodeBaseline = dailyValidations / networkNodes;
                const baselineValidationsPerNode = 17900 / baselineNetworkNodes; // 4.127
                
                // v5.6.1: Scale to match baseline (4.9662) which was calculated with 4339 nodes
                // The 4.9662 baseline includes EVLS already baked in from the data
                // So we need to adjust for network size differences
                const BASE_VAL_PER_NODE = 4.9662;  // Exact baseline from 12-month data
                const adjustmentFactor = BASE_VAL_PER_NODE / baselineValidationsPerNode;
                const BASELINE_VAL_PER_NODE_PER_DAY = validationsPerNodeBaseline * adjustmentFactor;
                
                const networkPercentage = ((nodes / networkNodes) * 100).toFixed(2);
                
                // Calculate EVLS factor (same as Multi-Node table)
                const evlsFactor = calculateEVLSFactor(nodes);
                const evlsPenaltyPercent = ((1 - evlsFactor) * 100).toFixed(2);
                
                // v5.6.1: Use 12-month reward rate (0.10) to match Multi-Node table
                const reward12m = 0.10;
                
                // v5.6.1: Calculate validations using SAME method as Multi-Node table
                const validationsPerNodePerDay = BASELINE_VAL_PER_NODE_PER_DAY * evlsFactor;
                const totalValidationsPerDay = validationsPerNodePerDay * nodes;
                const yearlyValidations = totalValidationsPerDay * 365;
                
                // Calculate MNW rewards (12-month rate, with EVLS)
                const yearlyMNW = yearlyValidations * reward12m;
                
                // Calculate Token Yield (always based on MNW, independent of price)
                const tokenYield = (yearlyMNW / (stakePerNode * nodes)) * 100;
                
                // Get VPS count
                const vpsCount = parseInt(document.getElementById('myVPSCount').value) || 1;
                
                // Calculate VPS cost (per VPS, not per node!)
                const vpsPerUnit = nodes <= 100 ? 6.00 : 24.00;
                const totalAnnualVPSCost = vpsPerUnit * 12 * vpsCount;
                
                // Calculate profits (total rewards minus total VPS cost) - NOW USES CURRENT PRICE
                const totalAnnualRewardsUSD = yearlyMNW * currentPrice;
                const totalAnnualProfit = totalAnnualRewardsUSD - totalAnnualVPSCost;
                
                // Calculate ROI (using current price, matching the table)
                const totalInvestment = stakePerNode * nodes * currentPrice;
                const roi = (totalAnnualProfit / totalInvestment) * 100;
                
                // Calculate total staked
                const totalStaked = stakePerNode * nodes;
                
                // Update display
                document.getElementById('myNodesEVLS').textContent = evlsPenaltyPercent + '%';
                document.getElementById('myNodesEVLS').style.color = evlsFactor >= 1.0 ? '#4ade80' : evlsPenaltyPercent < 15 ? '#fbbf24' : '#f87171';
                
                document.getElementById('myNodesTokenYield').textContent = tokenYield.toFixed(2) + '%';
                document.getElementById('myNodesTokenYield').style.color = tokenYield >= 8.0 ? '#4ade80' : tokenYield >= 6.0 ? '#fbbf24' : '#f87171';
                
                document.getElementById('myNodesProfit').textContent = '$' + formatNumber(Math.round(totalAnnualProfit));
                document.getElementById('myNodesProfit').style.color = totalAnnualProfit > 0 ? '#4ade80' : '#f87171';
                
                document.getElementById('myNodesROI').textContent = roi.toFixed(2) + '%';
                document.getElementById('myNodesROI').style.color = roi >= 10 ? '#4ade80' : roi >= 5 ? '#fbbf24' : '#f87171';
                
                // v5.6.1: Add Daily Validations display
                document.getElementById('myNodesDailyVals').textContent = formatNumber(Math.round(totalValidationsPerDay));
                
                // v1.0.1: Add Yearly Validations display
                document.getElementById('myNodesYearlyVals').textContent = formatNumber(Math.round(yearlyValidations));
                
                document.getElementById('myNodesVPS').textContent = '$' + (vpsPerUnit * 12).toFixed(0) + '/yr √ó ' + vpsCount;
                
                document.getElementById('myNodesStaked').textContent = formatCompactMNW(stakePerNode * nodes);
                
                // Update network percentage display
                document.getElementById('myNodesCount').textContent = formatNumber(nodes);
                document.getElementById('myNodesLabel').textContent = nodes === 1 ? 'node' : 'nodes';
                document.getElementById('myNodesPercentage').textContent = networkPercentage + '%';
                document.getElementById('myNodesNetworkSize').textContent = formatNumber(networkNodes);
            } catch (error) {
                console.error('Error in calculateMyNodes:', error);
            }
        }


        function updateVelocity() {
            const velocity = parseFloat(document.getElementById('velocitySlider').value);
            document.getElementById('velocityDisplay').textContent = velocity.toFixed(1) + 'x';
            
            let interpretation = '';
            if (velocity < 1.5) {
                interpretation = 'Strong HODLing behavior - Most validators stake/hold rewards';
            } else if (velocity < 3.0) {
                interpretation = 'Moderate trading - Mix of holding and selling to cover costs';
            } else {
                interpretation = 'High turnover - Active selling pressure from validators';
            }
            document.getElementById('velocityInterpretation').textContent = interpretation;
        }

        function switchTab(tabName) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(t => t.classList.remove('active'));
            contents.forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        function calculate() {
            try {
                // v1.0.1: Ensure network display boxes are updated with formatted numbers
                updateNetworkDisplays();
                
                const totalSupply = parseFormattedNumber(document.getElementById('totalSupply').value);
                const teamWallet = parseFormattedNumber(document.getElementById('teamWallet').value);
                const totalNodes = parseFormattedNumber(document.getElementById('totalNodes').value);
                const activeValidators = parseFormattedNumber(document.getElementById('activeValidators').value);
                const stakePerNode = parseFormattedNumber(document.getElementById('stakePerNode').value);
                const totalStaked = parseFormattedNumber(document.getElementById('totalStaked').value);
                const cexLocked = parseFormattedNumber(document.getElementById('cexLocked').value);
                const polygonMNW = parseFormattedNumber(document.getElementById('polygonMNW').value);
                const ethereumMNW = parseFormattedNumber(document.getElementById('ethereumMNW').value);
                const lostTokens = parseFormattedNumber(document.getElementById('lostTokens').value);
                
                // DEX Liquidity is now a fixed input value (current actual liquidity)
                const dexLiquidity = parseFormattedNumber(document.getElementById('dexLiquidity').value);
                
                // Calculate suggested DEX (10% of Ethereum MNW) for reference
                const suggestedDEX = Math.round(ethereumMNW * 0.10);
                
                const currentPrice = parseFloat(document.getElementById('currentPrice').value) || 0.0875;
                const dailyValidations = parseFormattedNumber(document.getElementById('dailyValidations').value);
                const yearlyValidations = parseFormattedNumber(document.getElementById('yearlyValidations').value);
                
                // Calculate node:validator ratio from INPUT BOXES (this is the fixed network ratio)
                const nodeValidatorRatio = totalNodes / activeValidators;
                
                // CONSTANTS FOR SCALING MODEL
                const MAX_NODES = 20000;
                const MAX_STAKEABLE = MAX_NODES * 1800;
                const baselineDailyVals = 17900;
                const baselineNodes = 4335;
                const baselineValidators = 108;
                const baselinePrice = 0.062;
                const currentNodesBaseline = 4335;
                const currentValsBaseline = 18500;
                
                // Use actual Total Nodes input value for display
                const scaledNodes = totalNodes;
                
                // Use actual Active Validators input value for display
                const scaledValidators = activeValidators;
                const scaledStaked = scaledNodes * stakePerNode;
                
                // ACTUAL STAKED (for supply accounting) - uses real Total Nodes input
                const actualStaked = totalNodes * stakePerNode;
                
                // v1.0.1: Calculate Polygon and Ethereum wallets based on available supply
                // Total Supply - Staked - Team Wallet - DEX - CEX - Lost = Available for wallets
                const availableForWallets = totalSupply - actualStaked - teamWallet - dexLiquidity - cexLocked - lostTokens;
                
                // Calculate ratio from original input values
                const totalInputWallets = polygonMNW + ethereumMNW;
                const polygonRatio = totalInputWallets > 0 ? polygonMNW / totalInputWallets : 0.07;  // ~7% default
                const ethereumRatio = totalInputWallets > 0 ? ethereumMNW / totalInputWallets : 0.93; // ~93% default
                
                // Distribute available wallet amount based on ratio
                const adjustedPolygonMNW = Math.max(0, Math.round(availableForWallets * polygonRatio));
                const adjustedEthereumMNW = Math.max(0, Math.round(availableForWallets * ethereumRatio));
                
                // DYNAMIC SUPPLY DISTRIBUTION based on network maturity
                const networkMaturity = scaledNodes / MAX_NODES;
                
                // CRITICAL THRESHOLD: Above 66,450 daily validations, team wallet is depleted
                const validationThresholdExceeded = dailyValidations > 66450;
                
                // Team wallet depletes as network grows OR if validation threshold exceeded
                const dynamicTeamWallet = validationThresholdExceeded ? 0 : Math.max(0, Math.round(teamWallet * (1 - networkMaturity * 1.2)));
                
                // CEX, DEX remain as input values, but Polygon and Ethereum are adjusted
                const dynamicCexLocked = cexLocked;
                const dynamicDexLiquidity = dexLiquidity;
                const dynamicPolygonMNW = adjustedPolygonMNW;
                const dynamicEthereumWallets = adjustedEthereumMNW;
                
                // Verify total using ACTUAL staked (for debugging)
                const calculatedTotal = dynamicTeamWallet + actualStaked + dynamicCexLocked + dynamicDexLiquidity + dynamicPolygonMNW + dynamicEthereumWallets + lostTokens;
                
                const mnwInWalletsTotal = dynamicPolygonMNW + dynamicEthereumWallets;
                const liquidSupply = dynamicDexLiquidity + mnwInWalletsTotal + dynamicCexLocked;
                const overhangPercent = (liquidSupply / totalSupply * 100).toFixed(1);
                
                // Update capacity model text with the fixed ratio from inputs
                document.getElementById('capacityModelText').innerHTML = 
                    `Node growth follows square root of validation growth (diminishing returns). Maximum: 20,000 nodes (36M MNW staked = 75% of supply). Validators scale at <strong>1:${Math.round(nodeValidatorRatio)} ratio</strong> (from inputs: ${formatNumber(totalNodes)} nodes √∑ ${formatNumber(activeValidators)} validators = ${nodeValidatorRatio.toFixed(1)} nodes/validator).`;
                
                // Calculate scaling projections for growth scenarios
                const calc3xVals = Math.round(currentValsBaseline * 3);
                const calc3xNodes = Math.min(Math.round(currentNodesBaseline * Math.sqrt(3)), MAX_NODES);
                const calc3xValidators = Math.round(calc3xNodes / nodeValidatorRatio);
                
                const calc10xVals = Math.round(currentValsBaseline * 10);
                const calc10xNodes = Math.min(Math.round(currentNodesBaseline * Math.sqrt(10)), MAX_NODES);
                const calc10xValidators = Math.round(calc10xNodes / nodeValidatorRatio);
                
                const calc100xVals = Math.round(currentValsBaseline * 100);
                const calc100xNodes = Math.min(Math.round(currentNodesBaseline * Math.sqrt(100)), MAX_NODES);
                const calc100xValidators = Math.round(calc100xNodes / nodeValidatorRatio);
                
                // Update scaling projections with expected prices
                
                document.getElementById('expected3xVals').textContent = formatNumber(calc3xVals);
                document.getElementById('expected3xNodes').textContent = `~${formatNumber(calc3xNodes)} Nodes`;
                document.getElementById('expected3xValidators').textContent = `~${formatNumber(calc3xValidators)} Validators`;
                document.getElementById('expected3xPrice').textContent = `Price: $${(baselinePrice * 3).toFixed(2)}`;
                
                document.getElementById('expected10xVals').textContent = formatNumber(calc10xVals);
                document.getElementById('expected10xNodes').textContent = `~${formatNumber(calc10xNodes)} Nodes`;
                document.getElementById('expected10xValidators').textContent = `~${formatNumber(calc10xValidators)} Validators`;
                document.getElementById('expected10xPrice').textContent = `Price: $${(baselinePrice * 10).toFixed(2)}`;
                
                document.getElementById('expected100xVals').textContent = formatNumber(calc100xVals);
                document.getElementById('expected100xNodes').textContent = calc100xNodes >= MAX_NODES ? `${formatNumber(calc100xNodes)} Nodes (MAX)` : `~${formatNumber(calc100xNodes)} Nodes`;
                document.getElementById('expected100xValidators').textContent = `${formatNumber(calc100xValidators)} Validators`;
                document.getElementById('expected100xPrice').textContent = `Price: $${(baselinePrice * 100).toFixed(2)}`;
                
                const nodes3m = parseFormattedNumber(document.getElementById('nodes3m').value);
                const reward3m = parseFloat(document.getElementById('reward3m').value) || 0.06;
                const nodes6m = parseFormattedNumber(document.getElementById('nodes6m').value);
                const reward6m = parseFloat(document.getElementById('reward6m').value) || 0.08;
                const nodes12m = parseFormattedNumber(document.getElementById('nodes12m').value);
                const reward12m = parseFloat(document.getElementById('reward12m').value) || 0.10;
                
                const velocity = parseFloat(document.getElementById('velocitySlider').value);
                
                // Calculate weighted average reward
                const totalNodeSum = nodes3m + nodes6m + nodes12m;
                const weightedAvgReward = ((nodes3m * reward3m) + (nodes6m * reward6m) + (nodes12m * reward12m)) / totalNodeSum;
                
                // Calculate yearly network rewards (accounting for EVLS)
                // Base emissions: dailyValidations √ó avgReward √ó 365
                const baseYearlyRewards = dailyValidations * weightedAvgReward * 365;
                // EVLS reduces total emissions by ~3% (conservative estimate)
                // Assumptions: ~85% of nodes with small operators (0% EVLS penalty)
                //              ~15% of nodes with large operators (avg 20% EVLS penalty)
                // Network-wide impact: 0.85√ó0% + 0.15√ó20% = 3% reduction
                const evlsReductionFactor = 0.97; // 3% reduction from EVLS penalties
                const yearlyRewards = baseYearlyRewards * evlsReductionFactor;
                const inflationRate = (yearlyRewards / totalSupply) * 100;
                
                // Update info box with current emissions calculations
                document.getElementById('baseEmissions').textContent = (baseYearlyRewards / 1000000).toFixed(2);
                document.getElementById('netEmissions').textContent = (yearlyRewards / 1000000).toFixed(2);
                
                // Effective average reward after EVLS
                const effectiveAvgReward = weightedAvgReward * evlsReductionFactor;
                
                const marketCap = totalSupply * currentPrice;
                
                document.getElementById('velocityInfo').textContent = velocity.toFixed(1) + 'x';
                document.getElementById('currentVals').textContent = formatNumber(dailyValidations);
                document.getElementById('nodesDisplay').textContent = formatNumber(totalNodes);
                
                // Update validators display dynamically (nodes / 40 average)
                const calculatedValidators = Math.round(totalNodes / 40);
                document.getElementById('currentValidatorsDisplay').textContent = formatNumber(calculatedValidators) + ' validators globally';
                
                // Update Liquidity Tiers with dynamic values
                document.getElementById('tier1DexLiquidity').textContent = formatCompactMNW(dynamicDexLiquidity);
                document.getElementById('tier1EthereumWallets').textContent = formatCompactMNW(dynamicEthereumWallets);
                document.getElementById('tier1PolygonWallets').textContent = formatCompactMNW(dynamicPolygonMNW);
                
                // Calculate and update Tier 1 total
                const tier1Total = dynamicDexLiquidity + dynamicEthereumWallets + dynamicPolygonMNW;
                document.getElementById('tier1Total').textContent = formatCompactMNW(tier1Total);
                
                // Tier 2 (KuCoin) is constant
                const tier2Total = dynamicCexLocked; // 3.38M
                
                // Calculate Total Liquid (T1+T2)
                const totalLiquidSupply = tier1Total + tier2Total;
                document.getElementById('totalLiquid').textContent = formatCompactMNW(totalLiquidSupply);
                
                // Tier 3: Calculate dynamically based on actual staked nodes
                const stake3m = nodes3m * stakePerNode;
                const stake6m = nodes6m * stakePerNode;
                const stake12m = nodes12m * stakePerNode;
                const tier3Total = stake3m + stake6m + stake12m;
                
                // Update Tier 3 display values
                document.getElementById('stake3m').textContent = formatCompactMNW(stake3m);
                document.getElementById('stake6m').textContent = formatCompactMNW(stake6m);
                document.getElementById('stake12m').textContent = formatCompactMNW(stake12m);
                document.getElementById('tier3Total').textContent = formatCompactMNW(tier3Total);
                
                // Update Lost MNW display values
                document.getElementById('lostMNW').textContent = formatCompactMNW(lostTokens);
                document.getElementById('totalLostDisplay').textContent = formatCompactMNW(lostTokens);
                
                // Update Total Overhang (T1+T2+T3) - liquidSupply already includes T1+T2, need to add T3
                // liquidSupply = dexLiquidity + mnwInWalletsTotal + cexLocked
                document.getElementById('totalOverhang').textContent = formatCompactMNW(liquidSupply);
                
                // Update Effective Supply (total minus lost)
                const effectiveSupply = totalSupply - lostTokens;
                document.getElementById('effectiveSupply').textContent = formatCompactMNW(effectiveSupply);
                
                document.getElementById('overhangPercent').textContent = overhangPercent + '% of total supply is liquid/could sell';
                
                // Show/hide validation threshold alert
                const thresholdAlert = document.getElementById('validationThresholdAlert');
                if (validationThresholdExceeded) {
                    thresholdAlert.style.display = 'block';
                } else {
                    thresholdAlert.style.display = 'none';
                }
                
                document.getElementById('metricsDisplay').innerHTML = `
                    <div class="metric-card" style="background: linear-gradient(135deg, #6c757d 0%, #495057 100%);">
                        <h3>Total Supply</h3>
                        <div class="value">${formatCompactMNW(totalSupply)}</div>
                        <small>MNW cannot be minted</small>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <h3>Staked (${formatNumber(totalNodes)} nodes)</h3>
                        <div class="value">${formatCompactMNW(actualStaked)}</div>
                        <small>${nodes3m}√ó3m + ${nodes6m}√ó6m + ${nodes12m}√ó12m</small>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #20c997 0%, #17a2b8 100%);">
                        <h3>Team Wallet üí∞</h3>
                        <div class="value">${formatCompactMNW(teamWallet)}</div>
                        <small>Current balance</small>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">
                        <h3>Team Wallet EOY üí∞</h3>
                        <div class="value">${formatCompactMNW(dynamicTeamWallet)}</div>
                        <small>${validationThresholdExceeded ? '‚úÖ Depleted - Buybacks active!' : networkMaturity >= 0.8 ? '‚ö†Ô∏è Nearly depleted - buybacks soon!' : 'Projected end of year'}</small>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);">
                        <h3>Current DEX LP üíß</h3>
                        <div class="value">${formatCompactMNW(dynamicDexLiquidity)}</div>
                        <small>Sushiswap, Uniswap</small>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);">
                        <h3>CEX Locked ‚ö†Ô∏è</h3>
                        <div class="value">${formatCompactMNW(dynamicCexLocked)}</div>
                        <small>Remains locked</small>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">
                        <h3>Polygon MNW üî∑</h3>
                        <div class="value">${formatCompactMNW(dynamicPolygonMNW)}</div>
                        <small>Bridged, not staked</small>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #fd7e14 0%, #e8590c 100%);">
                        <h3>Ethereum MNW üíº</h3>
                        <div class="value">${formatCompactMNW(dynamicEthereumWallets)}</div>
                        <small>Wallets on Ethereum</small>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #6c757d 0%, #495057 100%);">
                        <h3>Lost MNW üîí</h3>
                        <div class="value">${formatCompactMNW(lostTokens)}</div>
                        <small>Permanently inaccessible</small>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <h3>Active Nodes</h3>
                        <div class="value">${formatNumber(scaledNodes)}</div>
                        <small>${scaledValidators} validators globally</small>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #fd7e14 0%, #e8590c 100%);">
                        <h3>Avg Reward üìä</h3>
                        <div class="value">${effectiveAvgReward.toFixed(4)} MNW</div>
                        <small>Per validation (after EVLS)</small>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #6f42c1 0%, #5a32a3 100%);">
                        <h3>Yearly Rewards üí∞</h3>
                        <div class="value">${formatCompactMNW(yearlyRewards)}</div>
                        <small>Network-wide (~3% EVLS reduction)</small>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">
                        <h3>MNW Price üü¢</h3>
                        <div class="value">$${currentPrice.toFixed(4)}</div>
                        <small>Current market price</small>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <h3>Market Cap üü£</h3>
                        <div class="value">${formatCompactNumber(marketCap)}</div>
                        <small>Total Supply √ó Price</small>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);">
                        <h3>Daily Validations üîµ</h3>
                        <div class="value">${formatCompactMNW(dailyValidations)}</div>
                        <small>Current network activity</small>
                    </div>
                    <div class="metric-card" style="background: linear-gradient(135deg, #6610f2 0%, #6f42c1 100%);">
                        <h3>Yearly Validations üìà</h3>
                        <div class="value">${formatCompactMNW(yearlyValidations)}</div>
                        <small>${formatCompactMNW(dailyValidations)} √ó 365 days</small>
                    </div>
                `;
                
                // Populate verification table
                const verificationData = [
                    { category: 'Staked MNW', amount: actualStaked },
                    { category: 'Team Wallet (Current)', amount: teamWallet },
                    { category: 'Current DEX LP', amount: dynamicDexLiquidity },
                    { category: 'CEX Locked', amount: dynamicCexLocked },
                    { category: 'Polygon MNW', amount: dynamicPolygonMNW },
                    { category: 'Ethereum MNW', amount: dynamicEthereumWallets },
                    { category: 'Lost MNW', amount: lostTokens }
                ];
                
                const totalVerification = verificationData.reduce((sum, item) => sum + item.amount, 0);
                
                let tableHTML = '';
                verificationData.forEach(item => {
                    const percentage = ((item.amount / totalSupply) * 100).toFixed(2);
                    tableHTML += `
                        <tr>
                            <td style="padding: 10px 20px;"><strong>${item.category}</strong></td>
                            <td style="text-align: right; padding: 10px 20px; white-space: nowrap;">${formatNumber(Math.round(item.amount))}</td>
                            <td style="text-align: right; padding: 10px 15px;">${percentage}%</td>
                        </tr>
                    `;
                });
                
                tableHTML += `
                    <tr style="border-top: 3px solid var(--primary); font-weight: 700; background: var(--gray-100);">
                        <td style="padding: 12px 20px;"><strong>TOTAL</strong></td>
                        <td style="text-align: right; padding: 12px 20px; white-space: nowrap;">${formatNumber(Math.round(totalVerification))}</td>
                        <td style="text-align: right; padding: 12px 15px;">100.00%</td>
                    </tr>
                `;
                
                document.getElementById('verificationTableBody').innerHTML = tableHTML;
                
                const vpsCostPerYear = 72; // $6/month for up to 100 nodes
                const vpsCostPerYear100Plus = 288; // $24/month for 101+ nodes
                
                const validationsPerNode = dailyValidations / scaledNodes;
                const annualValidations = validationsPerNode * 365;
                const annualRewardsMNW = annualValidations * weightedAvgReward;
                const annualRewardsUSD = annualRewardsMNW * currentPrice;
                
                // Single node economics (uses $6/month = $72/year VPS)
                const netProfit = annualRewardsUSD - vpsCostPerYear;
                const stakeValueUSD = stakePerNode * currentPrice;
                const roiPercent = (netProfit / stakeValueUSD) * 100;
                
                // NEW v5.5: Token Yield (Universal metric)
                const tokenYieldPercent = (annualRewardsMNW / stakePerNode) * 100;
                
                const breakEven = vpsCostPerYear / annualRewardsMNW;
                const minNodesToBreakEven = Math.ceil(vpsCostPerYear / annualRewardsUSD);
                
                document.getElementById('annualRewardsPerNode').innerHTML = 
                    `${formatNumber(Math.round(annualRewardsMNW))} MNW<br><small>($${formatNumber(Math.round(annualRewardsUSD))} @ current price)</small>`;
                
                // NEW v5.5: Display Token Yield
                document.getElementById('tokenYield').innerHTML = 
                    `<span style="font-size: 1.3em;">${tokenYieldPercent.toFixed(2)}%</span><br><small style="color: #2e7d32;">MNW earned / MNW staked</small>`;
                
                document.getElementById('breakEvenPrice').textContent = '$' + breakEven.toFixed(5);
                document.getElementById('singleNodeROI').innerHTML = 
                    `<span style="color: ${netProfit >= 0 ? '#28a745' : '#dc3545'}">${netProfit >= 0 ? '$' + formatNumber(Math.round(netProfit)) : '-$' + formatNumber(Math.round(Math.abs(netProfit)))}/year</span><br><small>(${roiPercent.toFixed(1)}% ROI @ current price)</small>`;
                document.getElementById('minNodesToBreakEven').innerHTML = 
                    `<span style="color: #28a745; font-weight: bold;">${minNodesToBreakEven}</span><br><small>nodes per VPS</small>`;
                
                const nodeConfigs = [
                    {nodes: 1, vps: 1}, {nodes: 5, vps: 1}, {nodes: 10, vps: 1},
                    {nodes: 25, vps: 1}, {nodes: 50, vps: 1}, {nodes: 60, vps: 1},
                    {nodes: 70, vps: 1}, {nodes: 75, vps: 1}, {nodes: 80, vps: 1},
                    {nodes: 90, vps: 1}, {nodes: 100, vps: 1}, {nodes: 125, vps: 1},
                    {nodes: 150, vps: 1}, {nodes: 175, vps: 1}, {nodes: 200, vps: 1},
                    {nodes: 250, vps: 1}, {nodes: 500, vps: 1}, {nodes: 1000, vps: 1}
                ];
                
                // v1.0.1: Calculate per-node validations accounting for NETWORK SIZE (inverse relationship)
                // More network nodes = fewer validations per node
                const networkNodes = parseFormattedNumber(document.getElementById('totalNodes').value) || 4339;
                const baselineNetworkNodes = 4339;
                
                // Calculate actual per-node share of daily validations
                const validationsPerNodeFromNetwork = dailyValidations / networkNodes;
                
                // Baseline comparison (what it was at 4339 nodes and 17900 validations)
                const baselineValidationsPerNode = 17900 / baselineNetworkNodes; // 4.127
                
                // The 4.9662 baseline includes adjustment for actual validator performance
                const BASE_VAL_PER_NODE = 4.9662;  // Exact baseline from 12-month data
                const adjustmentFactor = BASE_VAL_PER_NODE / baselineValidationsPerNode;
                
                // Apply adjustment to get actual per-node validations
                const BASELINE_VAL_PER_NODE_PER_DAY = validationsPerNodeFromNetwork * adjustmentFactor;
                
                // v1.0.1: First pass - calculate all configs to find max ROI
                const calculatedConfigs = [];
                nodeConfigs.forEach(config => {
                    const vpsYearlyCost = config.nodes <= 100 ? vpsCostPerYear : vpsCostPerYear100Plus;
                    const evlsFactor = calculateEVLSFactor(config.nodes);
                    const evlsPenalty = (1 - evlsFactor) * 100;
                    
                    const validationsPerNodePerDay = BASELINE_VAL_PER_NODE_PER_DAY * evlsFactor;
                    const totalValidationsPerDay = validationsPerNodePerDay * config.nodes;
                    const yearlyValidations = totalValidationsPerDay * 365;
                    
                    const reward12m = 0.10;
                    const yearlyMNW = yearlyValidations * reward12m;
                    const yearlyUSD = yearlyMNW * currentPrice;
                    
                    const totalCost = vpsYearlyCost * config.vps;
                    const profit = yearlyUSD - totalCost;
                    const totalStakeValue = stakeValueUSD * config.nodes;
                    const multiROI = (profit / totalStakeValue) * 100;
                    
                    calculatedConfigs.push({
                        config: config,
                        vpsYearlyCost: vpsYearlyCost,
                        evlsFactor: evlsFactor,
                        evlsPenalty: evlsPenalty,
                        totalValidationsPerDay: totalValidationsPerDay,
                        yearlyValidations: yearlyValidations,
                        yearlyMNW: yearlyMNW,
                        profit: profit,
                        multiROI: multiROI,
                        multiTokenYield: (yearlyMNW / (stakePerNode * config.nodes)) * 100
                    });
                });
                
                // Find maximum ROI
                const maxROI = Math.max(...calculatedConfigs.map(c => c.multiROI));
                const roiTolerance = 0.01; // Consider ROIs within 0.01% as equal (for floating point)
                
                let multiNodeHTML = '';
                let showEVLS = false;
                calculatedConfigs.forEach(calc => {
                    const config = calc.config;
                    const costPerNodePerYear = calc.vpsYearlyCost / config.nodes;
                    
                    // EVLS loss calculation (compared to no penalty)
                    const yearlyValidationsNoPenalty = BASELINE_VAL_PER_NODE_PER_DAY * config.nodes * 365;
                    const evlsLossValidations = yearlyValidationsNoPenalty - calc.yearlyValidations;
                    const reward12m = 0.10;
                    const evlsLoss = evlsLossValidations * reward12m * currentPrice;
                    
                    if (config.nodes >= 100) showEVLS = true;
                    
                    // Color coding for profit: green for positive, red for negative
                    const profitColor = calc.profit >= 0 ? '#28a745' : '#dc3545';
                    
                    // v1.0.1: Dynamic styling - highlight ALL configs with maximum ROI
                    const isOptimal = Math.abs(calc.multiROI - maxROI) < roiTolerance;
                    let rowStyle = '';
                    let nodeLabel = `${config.nodes} Node${config.nodes > 1 ? 's' : ''} / ${config.vps} VPS`;
                    
                    if (isOptimal) {
                        // Optimal: highest ROI configuration(s)
                        rowStyle = 'background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); border: 2px solid #28a745;';
                        nodeLabel = `‚≠ê ${nodeLabel} (OPTIMAL - Max ROI)`;
                    } else if (config.nodes === 100) {
                        // 100 nodes: EVLS starts here (10.26% penalty)
                        rowStyle = 'background: #fff3cd;';
                        nodeLabel = `${nodeLabel}`;
                    } else if (config.nodes > 100 && config.nodes <= 150) {
                        // Yellow zone: EVLS active but manageable
                        rowStyle = 'background: #fff3cd;';
                    } else if (config.nodes > 150 && config.nodes < 500) {
                        // Orange zone: higher EVLS penalty
                        rowStyle = 'background: linear-gradient(135deg, #ffe8cc 0%, #ffd9a8 100%);';
                    } else if (config.nodes >= 500) {
                        // Red zone: severe EVLS penalty
                        rowStyle = 'background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%); border: 2px solid #dc3545;';
                        nodeLabel = `üö® ${nodeLabel} (HIGH PENALTY)`;
                    } else if (calc.profit < 0) {
                        // Unprofitable configurations
                        rowStyle = 'background: #f8d7da;';
                    }
                    
                    // EVLS penalty display
                    const evlsPenaltyDisplay = calc.evlsPenalty > 0 ? `${calc.evlsPenalty.toFixed(2)}%` : '‚Äî';
                    const evlsLossDisplay = evlsLoss > 0 ? `$${formatNumber(Math.round(evlsLoss))}` : '‚Äî';
                    const evlsFactorColor = calc.evlsPenalty > 0 ? '#dc3545' : '#28a745';
                    
                    multiNodeHTML += `
                        <tr style="${rowStyle}">
                            <td style="font-weight: ${isOptimal ? 'bold' : 'normal'};">${nodeLabel}</td>
                            <td style="text-align: right;">${formatNumber(config.nodes)}</td>
                            <td style="text-align: right; color: ${calc.evlsPenalty > 0 ? '#dc3545' : '#28a745'};">${formatNumber(Math.round(calc.totalValidationsPerDay))}</td>
                            <td style="text-align: right;">${formatNumber(Math.round(calc.yearlyValidations))}</td>
                            <td style="text-align: right;">${formatNumber(Math.round(calc.yearlyMNW))}</td>
                            <td style="text-align: right;">$${costPerNodePerYear.toFixed(2)}</td>
                            <td style="text-align: right; color: ${evlsFactorColor};">${calc.evlsFactor.toFixed(2)}x</td>
                            <td style="text-align: right; color: ${calc.evlsPenalty > 0 ? '#dc3545' : '#6c757d'};">${evlsPenaltyDisplay}</td>
                            <td style="text-align: right; color: ${evlsLoss > 0 ? '#dc3545' : '#6c757d'};">${evlsLossDisplay}</td>
                            <td style="text-align: right; color: ${profitColor}; font-weight: bold;">${calc.profit >= 0 ? '$' + formatNumber(Math.round(calc.profit)) : '-$' + formatNumber(Math.round(Math.abs(calc.profit)))}</td>
                            <td style="text-align: right; font-weight: ${isOptimal ? 'bold' : 'normal'}; color: ${isOptimal ? '#28a745' : 'inherit'};">${calc.multiTokenYield.toFixed(2)}%</td>
                            <td style="text-align: right; font-weight: ${isOptimal ? 'bold' : 'normal'}; color: ${isOptimal ? '#28a745' : 'inherit'};">${calc.multiROI.toFixed(2)}%</td>
                        </tr>
                    `;
                });
                document.getElementById('multiNodeTable').innerHTML = multiNodeHTML;
                
                // v1.0.1: Update optimal nodes text dynamically
                const optimalConfigs = calculatedConfigs.filter(c => Math.abs(c.multiROI - maxROI) < roiTolerance);
                const optimalNodeCounts = optimalConfigs.map(c => c.config.nodes).sort((a, b) => a - b);
                let optimalText = '';
                if (optimalNodeCounts.length === 1) {
                    optimalText = `‚úÖ ${optimalNodeCounts[0]} Nodes = OPTIMAL (Max ROI: ${maxROI.toFixed(2)}%)`;
                } else if (optimalNodeCounts.length === 2) {
                    optimalText = `‚úÖ ${optimalNodeCounts[0]} & ${optimalNodeCounts[1]} Nodes = OPTIMAL (Max ROI: ${maxROI.toFixed(2)}%)`;
                } else if (optimalNodeCounts.length <= 4) {
                    const lastNode = optimalNodeCounts.pop();
                    optimalText = `‚úÖ ${optimalNodeCounts.join(', ')} & ${lastNode} Nodes = OPTIMAL (Max ROI: ${maxROI.toFixed(2)}%)`;
                } else {
                    optimalText = `‚úÖ ${optimalNodeCounts.join(', ')} Nodes = OPTIMAL (Max ROI: ${maxROI.toFixed(2)}%)`;
                }
                document.getElementById('optimalNodesText').textContent = optimalText;
                
                // Calculate key profitability metrics with CORRECTED baseline (4.97)
                const validationsPerNode75 = BASELINE_VAL_PER_NODE_PER_DAY * calculateEVLSFactor(75) * 365;
                const validationsPerNode100 = BASELINE_VAL_PER_NODE_PER_DAY * calculateEVLSFactor(100) * 365;
                const validationsPerNode200 = BASELINE_VAL_PER_NODE_PER_DAY * calculateEVLSFactor(200) * 365;
                
                const profitAt75 = (validationsPerNode75 * 75 * 0.10 * currentPrice) - vpsCostPerYear;
                const profitAt100 = (validationsPerNode100 * 100 * 0.10 * currentPrice) - vpsCostPerYear;
                const profitAt200 = (validationsPerNode200 * 200 * 0.10 * currentPrice) - vpsCostPerYear100Plus;
                
                const roi75 = (profitAt75 / (stakeValueUSD * 75)) * 100;
                const roi100 = (profitAt100 / (stakeValueUSD * 100)) * 100;
                const roi200 = (profitAt200 / (stakeValueUSD * 200)) * 100;
                
                const evlsPenalty100 = ((1 - calculateEVLSFactor(100)) * 100).toFixed(2);
                const evlsPenalty200 = ((1 - calculateEVLSFactor(200)) * 100).toFixed(1);
                const evlsLoss200 = (200 * BASELINE_VAL_PER_NODE_PER_DAY * 365 * (1 - calculateEVLSFactor(200)) * 0.10 * currentPrice);
                
                document.getElementById('multiNodeInsight').innerHTML = 
                    `<strong>üí° Optimal Strategy:</strong> <strong style="color: #28a745;">75-99 nodes = SWEET SPOT</strong> with cheap $6/month VPS and no EVLS. 75 nodes: <strong>$${formatNumber(Math.round(profitAt75))}/year (${roi75.toFixed(2)}% ROI)</strong>. 100 nodes: <strong>$${formatNumber(Math.round(profitAt100))}/year (${roi100.toFixed(2)}% ROI)</strong> but ${evlsPenalty100}% EVLS starts. At 101+ nodes, VPS jumps 4x ($72‚Üí$288/year). At 200 nodes: ${evlsPenalty200}% EVLS penalty costs <strong style="color: #dc3545;">$${formatNumber(Math.round(evlsLoss200))}/year</strong>, ROI drops to ${roi200.toFixed(2)}%. <em>Do not extrapolate beyond 200 nodes - insufficient data.</em>`;
                
                document.getElementById('evlsWarning').style.display = showEVLS ? 'block' : 'none';
                
                const priceTargets = [0.10, 0.20, 0.30, 0.40, 0.50, 1.00, 5.00, 10.00, 15.00, 20.00, 25.00];
                let validationsTableHTML = `
                    <table>
                        <thead>
                            <tr>
                                <th>Price</th>
                                <th>Multiplier</th>
                                <th>Required Validations/Day</th>
                                <th>Daily Buyback ($)</th>
                                <th>Runway (Months)</th>
                                <th>Exhaustion Date</th>
                                <th>Market Cap</th>
                                <th>Velocity MCap</th>
                                <th>Implied Annual Revenue</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                priceTargets.forEach(price => {
                    const multiplier = price / currentPrice;
                    const requiredVals = dailyValidations * multiplier;
                    const dailyOutflowMNW = requiredVals * weightedAvgReward;
                    const dailyBuyback = dailyOutflowMNW * price;
                    const runwayDays = teamWallet / dailyOutflowMNW;
                    const runway = runwayDays / 30.44;
                    const exhaustDate = new Date();
                    exhaustDate.setDate(exhaustDate.getDate() + Math.floor(runwayDays));
                    const mcap = totalSupply * price;
                    const velocityMcap = mcap * velocity;
                    const impliedRevenue = (requiredVals * 365 * weightedAvgReward * price);
                    
                    validationsTableHTML += `
                        <tr>
                            <td>$${price.toFixed(2)}</td>
                            <td>${multiplier.toFixed(1)}x</td>
                            <td>${formatNumber(Math.round(requiredVals))}</td>
                            <td>$${formatNumber(Math.round(dailyBuyback))}</td>
                            <td>${isFinite(runway) ? runway.toFixed(1) : '‚àû'}</td>
                            <td>${isFinite(runway) ? exhaustDate.toLocaleDateString() : 'N/A'}</td>
                            <td>${formatCompactNumber(mcap)}</td>
                            <td>${formatCompactNumber(velocityMcap)}</td>
                            <td>${formatCompactNumber(impliedRevenue)}</td>
                        </tr>
                    `;
                });
                
                validationsTableHTML += '</tbody></table>';
                document.getElementById('tableContainer').innerHTML = validationsTableHTML;
                
                generateValidationsChart(priceTargets, currentPrice, dailyValidations);
                generateRunwayChart(priceTargets, dynamicTeamWallet, weightedAvgReward, dailyValidations, currentPrice);
                generateCliffEventsChart(scaledStaked, dynamicTeamWallet, currentPrice, scaledNodes, dailyValidations);
                generateBuybackChart(priceTargets, dailyValidations, weightedAvgReward);
                generateVelocityChart(priceTargets, totalSupply, velocity, dailyValidations, currentPrice, weightedAvgReward);
                
            } catch (error) {
                console.error('Calculation error:', error);
                alert('Error in calculations: ' + error.message);
            }
        }
        
        function generateValidationsChart(prices, currentPrice, currentVals) {
            const validations = prices.map(p => currentVals * (p / currentPrice));
            
            Plotly.newPlot('validationsChart', [{
                x: prices.map(p => '$' + p.toFixed(2)),
                y: validations,
                type: 'bar',
                marker: { 
                    color: '#667eea', 
                    line: { width: 2, color: '#764ba2' } 
                },
                text: validations.map(v => formatNumber(Math.round(v))),
                textposition: 'outside',
                textfont: { 
                    size: 18,  // Increased from 14
                    family: 'Arial', 
                    weight: 'bold',
                    color: '#333'
                },
                width: 0.7  // Reduced from 0.9 for better spacing
            }], {
                title: { 
                    text: 'Validation Volume Required for Each Price Target', 
                    font: { size: 20, weight: 'bold' }  // Increased from 18
                },
                xaxis: { 
                    title: 'Target Price', 
                    titlefont: { size: 16 },  // Increased from 14
                    tickfont: { size: 14 },   // Increased from 12
                    tickprefix: '$',
                    tickangle: -45  // Angle labels for better readability
                },
                yaxis: { 
                    title: 'Daily Validations', 
                    titlefont: { size: 16 },  // Increased from 14
                    tickfont: { size: 14 },   // Increased from 12
                    rangemode: 'tozero',
                    automargin: true
                },
                margin: { l: 100, r: 60, t: 100, b: 100 },  // Increased margins for labels
                plot_bgcolor: '#f8f9fa',
                paper_bgcolor: '#f8f9fa',
                bargap: 0.2,  // Increased from 0.05 for better spacing
                autosize: true,
                height: 650  // Taller chart
            }, { displayModeBar: false, responsive: true });
        }
        
        function generateRunwayChart(prices, teamWallet, avgReward, dailyVals, currentPrice) {
            const runway = prices.map(price => {
                const requiredVals = dailyVals * (price / currentPrice);
                const dailyOutflow = requiredVals * avgReward;
                return teamWallet / dailyOutflow / 30.44;
            }).filter(r => isFinite(r) && r > 0);
            
            const validPrices = prices.filter((p, i) => {
                const requiredVals = dailyVals * (p / currentPrice);
                const dailyOutflow = requiredVals * avgReward;
                const r = teamWallet / dailyOutflow / 30.44;
                return isFinite(r) && r > 0;
            });
            
            Plotly.newPlot('runwayChart', [{
                x: validPrices.map(p => '$' + p.toFixed(2)),
                y: runway,
                type: 'scatter',
                mode: 'lines+markers+text',
                line: { color: '#dc3545', width: 3 },
                marker: { size: 12, color: '#c82333' },
                fill: 'tozeroy',
                fillcolor: 'rgba(220, 53, 69, 0.2)',
                text: runway.map(r => r.toFixed(1) + 'm'),
                textposition: 'top center',
                textfont: { size: 16, weight: 'bold' }
            }], {
                title: 'Team Wallet Runway at Different Price Levels (The Death Cross)',
                xaxis: { title: 'Target Price', tickprefix: '$' },
                yaxis: { title: 'Runway (Months Until Depletion)' },
                margin: { l: 80, r: 40, t: 80, b: 60 },
                plot_bgcolor: '#f8f9fa',
                paper_bgcolor: '#f8f9fa',
                shapes: [
                    { type: 'line', y0: 6, y1: 6, x0: 0, x1: 1, xref: 'paper', line: { color: '#fd7e14', width: 2, dash: 'dash' } },
                    { type: 'line', y0: 3, y1: 3, x0: 0, x1: 1, xref: 'paper', line: { color: '#dc3545', width: 2, dash: 'dash' } }
                ],
                annotations: [
                    { text: '6 Month Warning', xref: 'paper', x: 0.5, y: 6, showarrow: false, yshift: 10, font: { color: '#fd7e14' } },
                    { text: '3 Month Critical', xref: 'paper', x: 0.5, y: 3, showarrow: false, yshift: 10, font: { color: '#dc3545' } }
                ]
            }, { displayModeBar: false, responsive: true });
        }
        
        function generateCliffEventsChart(totalStaked, teamWallet, currentPrice, scaledNodes, dailyValidations) {
            const cliffData = [
                { period: 'Early 2026\n(Jan-Jun)', nodePercent: 30.7, mnwPercent: 28.8, color: '#ffc107' },
                { period: 'Summer 2026\n(Jul-Aug)', nodePercent: 38.6, mnwPercent: 40.9, color: '#dc3545' },
                { period: 'Fall 2026\n(Sep-Oct)', nodePercent: 15.8, mnwPercent: 14.7, color: '#fd7e14' },
                { period: 'Late 2026\n(Nov-Dec)', nodePercent: 14.9, mnwPercent: 15.6, color: '#20c997' }
            ];
            
            // Use SCALED values passed from calculate()
            const nodes3m = parseFormattedNumber(document.getElementById('nodes3m').value);
            const reward3m = parseFloat(document.getElementById('reward3m').value);
            const nodes6m = parseFormattedNumber(document.getElementById('nodes6m').value);
            const reward6m = parseFloat(document.getElementById('reward6m').value);
            const nodes12m = parseFormattedNumber(document.getElementById('nodes12m').value);
            const reward12m = parseFloat(document.getElementById('reward12m').value);
            
            const totalNodeSum = nodes3m + nodes6m + nodes12m;
            const weightedAvgReward = ((nodes3m * reward3m) + (nodes6m * reward6m) + (nodes12m * reward12m)) / totalNodeSum;
            
            // Use SCALED NODES for realistic projections
            const validationsPerNodePerDay = dailyValidations / scaledNodes;
            const validationsPerNodePerYear = validationsPerNodePerDay * 365;
            const mnwPerNodePerYear = validationsPerNodePerYear * weightedAvgReward;
            const actualAnnualPayout = mnwPerNodePerYear * scaledNodes;
            
            const mnwAmounts = cliffData.map(d => actualAnnualPayout * (d.mnwPercent / 100));
            const teamWalletPercents = mnwAmounts.map(amt => (amt / teamWallet * 100).toFixed(1));
            
            Plotly.newPlot('cliffEventsChart', [{
                x: cliffData.map(d => d.period),
                y: mnwAmounts,
                type: 'bar',
                marker: { color: cliffData.map(d => d.color) },
                text: mnwAmounts.map((m, i) => formatNumber(Math.round(m)) + ' MNW<br>' + cliffData[i].mnwPercent + '% of annual'),
                textposition: 'outside',
                textfont: { size: 12 }
            }], {
                title: '2026 Stake Maturity Events (Actual Payouts at Current Rate)',
                xaxis: { title: 'Time Period' },
                yaxis: { title: 'Actual MNW Required' },
                margin: { l: 80, r: 40, t: 80, b: 100 },
                plot_bgcolor: '#f8f9fa',
                paper_bgcolor: '#f8f9fa',
                annotations: [{
                    text: '‚ö†Ô∏è LARGEST EVENT',
                    x: 'Summer 2026\n(Jul-Aug)',
                    y: mnwAmounts[1],
                    showarrow: true,
                    arrowhead: 2,
                    yshift: 30,
                    font: { size: 14, color: '#dc3545', weight: 'bold' }
                }]
            }, { displayModeBar: false, responsive: true });
            
            let cliffBoxesHTML = '';
            cliffData.forEach((d, i) => {
                const bgColor = d.color === '#dc3545' ? 'background: #f8d7da; color: #721c24;' : 'background: white;';
                cliffBoxesHTML += `
                    <div class="cliff-box" style="${bgColor}">
                        <strong>${d.period.replace('\\n', ' ')}</strong>
                        <div style="margin-top: 10px;">
                            <div>${d.nodePercent}% of nodes | ${d.mnwPercent}% of MNW</div>
                            <div style="margin-top: 5px; font-size: 1.2em; font-weight: bold;">${formatCompactMNW(Math.round(mnwAmounts[i]))} MNW</div>
                            <div style="margin-top: 5px; font-size: 0.9em;">${teamWalletPercents[i]}% of team wallet</div>
                        </div>
                    </div>
                `;
            });
            
            const totalCliffPayouts = mnwAmounts.reduce((sum, amt) => sum + amt, 0);
            const remainingAfterCliffs = Math.max(0, teamWallet - totalCliffPayouts);
            const utilizationPercent = teamWallet > 0 ? ((totalCliffPayouts / teamWallet * 100).toFixed(1)) : '‚àû';
            const isDepleted = totalCliffPayouts > teamWallet;
            const shortfall = isDepleted ? totalCliffPayouts - teamWallet : 0;
            
            cliffBoxesHTML += `
                <div style="grid-column: 1 / -1; background: ${isDepleted ? '#f8d7da' : '#e7f3ff'}; padding: 15px; border-radius: 8px; border: 2px solid ${isDepleted ? '#dc3545' : '#0066cc'};">
                    <div style="text-align: center;">
                        <strong style="font-size: 1.1em; color: ${isDepleted ? '#721c24' : '#0066cc'};">2026 SUMMARY (at ${formatNumber(dailyValidations)} val/day with ${formatNumber(scaledNodes)} nodes)</strong>
                        ${isDepleted ? '<div style="margin-top: 10px; font-weight: bold; color: #dc3545;">‚ö†Ô∏è TEAM WALLET INSUFFICIENT - BUYBACK REQUIRED!</div>' : ''}
                        <div style="margin-top: 10px; display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
                            <div>
                                <div style="font-size: 1.3em; font-weight: bold; color: ${isDepleted ? '#dc3545' : '#0066cc'};">${formatCompactMNW(Math.round(totalCliffPayouts))} MNW</div>
                                <div style="font-size: 0.9em;">Total 2026 Payouts</div>
                            </div>
                            <div>
                                <div style="font-size: 1.3em; font-weight: bold; color: ${remainingAfterCliffs > 0 ? '#28a745' : '#dc3545'};">${formatCompactMNW(Math.round(remainingAfterCliffs))} MNW</div>
                                <div style="font-size: 0.9em;">${isDepleted ? 'Depleted (0 MNW)' : 'Remaining After 2026'}</div>
                            </div>
                            <div>
                                <div style="font-size: 1.3em; font-weight: bold; color: ${isDepleted ? '#dc3545' : '#667eea'};">${utilizationPercent}%</div>
                                <div style="font-size: 0.9em;">Team Wallet Used</div>
                            </div>
                            ${isDepleted ? `
                            <div style="grid-column: 1 / -1; margin-top: 10px; padding: 10px; background: rgba(220, 53, 69, 0.1); border-radius: 5px;">
                                <div style="font-size: 1.1em; font-weight: bold; color: #dc3545;">Shortfall: ${formatCompactMNW(Math.round(shortfall))} MNW</div>
                                <div style="font-size: 0.85em; margin-top: 5px; color: #721c24;">Network must perform market buybacks to cover validator rewards</div>
                            </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('cliffInfoBoxes').innerHTML = cliffBoxesHTML;
        }
        
        function generateBuybackChart(prices, dailyVals, avgReward) {
            const buyback = prices.map((p, i) => {
                const requiredVals = dailyVals * (p / prices[0]);
                return requiredVals * avgReward * p;
            });
            
            Plotly.newPlot('buybackChart', [{
                x: prices.map(p => '$' + p.toFixed(2)),
                y: buyback,
                type: 'scatter',
                mode: 'lines',
                fill: 'tozeroy',
                fillcolor: 'rgba(40, 167, 69, 0.3)',
                line: { color: '#28a745', width: 3 },
                text: buyback.map(b => '$' + formatNumber(Math.round(b))),
                textposition: 'top center'
            }], {
                title: 'Required Daily Buy Pressure After Team Wallet Depletion',
                xaxis: { title: 'Price Target', tickprefix: '$' },
                yaxis: { title: 'Daily USD Buy Pressure Required', tickprefix: '$' },
                margin: { l: 80, r: 40, t: 80, b: 60 },
                plot_bgcolor: '#f8f9fa',
                paper_bgcolor: '#f8f9fa'
            }, { displayModeBar: false, responsive: true });
        }
        
        function generateVelocityChart(prices, totalSupply, velocity, dailyVals, currentPrice, avgReward) {
            const velocityRange = [0.5, 1.0, 1.5, 2.0, 3.0, 5.0, 7.5, 10.0];
            const targetPrice = 1.00;
            const baseMultiplier = targetPrice / currentPrice;
            const baseValidations = dailyVals * baseMultiplier;
            const validationsAtVelocities = velocityRange.map(v => baseValidations * v);
            
            Plotly.newPlot('velocityChart', [
                {
                    x: velocityRange,
                    y: validationsAtVelocities,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: 'Required Validations',
                    line: { color: '#667eea', width: 3 },
                    marker: { size: 10 }
                },
                {
                    x: [velocity, velocity],
                    y: [0, Math.max(...validationsAtVelocities)],
                    type: 'scatter',
                    mode: 'lines',
                    name: 'Current Setting',
                    line: { color: '#dc3545', width: 2, dash: 'dash' }
                }
            ], {
                title: 'How Token Velocity Affects Validation Requirements for $1.00 Target',
                xaxis: { title: 'Velocity Factor', ticksuffix: 'x' },
                yaxis: { title: 'Required Daily Validations' },
                margin: { l: 80, r: 40, t: 80, b: 60 },
                plot_bgcolor: '#f8f9fa',
                paper_bgcolor: '#f8f9fa',
                annotations: [
                    { x: 1.0, y: validationsAtVelocities[1], text: 'Strong HODL', showarrow: true, arrowhead: 2 },
                    { x: 3.0, y: validationsAtVelocities[4], text: 'Moderate', showarrow: true, arrowhead: 2 },
                    { x: 10.0, y: validationsAtVelocities[7], text: 'High Turnover', showarrow: true, arrowhead: 2 }
                ]
            }, { displayModeBar: false, responsive: true });
        }
        
        window.addEventListener('load', function() {
            // Initialize all fields
            updateCalculatedFields();
            updateYearlyValidations();
            updateVelocity();
            
            // Initialize display boxes from input values
            updateNetworkDisplays();
            
            calculate();
            
            // Initialize My Nodes calculator and network validators
            setTimeout(function() {
                updateMyNetworkValidators();
                calculateMyNodes();
            }, 100);
        });
    </script>
</body>
</html>
